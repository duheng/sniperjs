{"remainingRequest":"/Users/qitmac001131/Desktop/work/ykit3/packages/ykit3-config-resolver/node_modules/babel-loader/lib/index.js??ref--4-2!/Users/qitmac001131/Desktop/test/sniperjs/packages/WebErrorReporter/dist/index.js","dependencies":[{"path":"/Users/qitmac001131/Desktop/test/sniperjs/packages/WebErrorReporter/dist/index.js","hash":"3000f6f657722f90fd9de64b41165e5b"},{"path":"/Users/qitmac001131/Desktop/work/ykit3/packages/ykit3-config-resolver/node_modules/cache-loader-hash/dist/cjs.js","hash":"d62e2d390167bf8193569f1644327c55"},{"path":"/Users/qitmac001131/Desktop/work/ykit3/packages/ykit3-config-resolver/node_modules/babel-loader/lib/index.js","hash":"19adf3159c902f1ed7907f3931384270"}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgIkBiYWJlbC9oZWxwZXJzIC0gdHlwZW9mIjsgaWYgKHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gInN5bWJvbCIpIHsgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogdHlwZW9mIG9iajsgfTsgfSByZXR1cm4gX3R5cGVvZihvYmopOyB9CgooZnVuY3Rpb24gKGdsb2JhbCwgZmFjdG9yeSkgewogICh0eXBlb2YgZXhwb3J0cyA9PT0gInVuZGVmaW5lZCIgPyAidW5kZWZpbmVkIiA6IF90eXBlb2YoZXhwb3J0cykpID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJyA/IG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpIDogdHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kID8gZGVmaW5lKGZhY3RvcnkpIDogKGdsb2JhbCA9IGdsb2JhbCB8fCBzZWxmLCBnbG9iYWwuU25pcGVyanMgPSBmYWN0b3J5KCkpOwp9KSh2b2lkIDAsIGZ1bmN0aW9uICgpIHsKICAndXNlIHN0cmljdCc7CgogIGZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsKICAgIGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7CiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOwogICAgfQogIH0KCiAgZnVuY3Rpb24gX2RlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgewogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgewogICAgICB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOwogICAgICBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7CiAgICAgIGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsKICAgICAgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIF9jcmVhdGVDbGFzcyhDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsKICAgIGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOwogICAgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOwogICAgcmV0dXJuIENvbnN0cnVjdG9yOwogIH0KCiAgZnVuY3Rpb24gX2RlZmluZVByb3BlcnR5KG9iaiwga2V5LCB2YWx1ZSkgewogICAgaWYgKGtleSBpbiBvYmopIHsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7CiAgICAgICAgdmFsdWU6IHZhbHVlLAogICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgIHdyaXRhYmxlOiB0cnVlCiAgICAgIH0pOwogICAgfSBlbHNlIHsKICAgICAgb2JqW2tleV0gPSB2YWx1ZTsKICAgIH0KCiAgICByZXR1cm4gb2JqOwogIH0KCiAgZnVuY3Rpb24gb3duS2V5cyhvYmplY3QsIGVudW1lcmFibGVPbmx5KSB7CiAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG9iamVjdCk7CgogICAgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHsKICAgICAgdmFyIHN5bWJvbHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKG9iamVjdCk7CiAgICAgIGlmIChlbnVtZXJhYmxlT25seSkgc3ltYm9scyA9IHN5bWJvbHMuZmlsdGVyKGZ1bmN0aW9uIChzeW0pIHsKICAgICAgICByZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHN5bSkuZW51bWVyYWJsZTsKICAgICAgfSk7CiAgICAgIGtleXMucHVzaC5hcHBseShrZXlzLCBzeW1ib2xzKTsKICAgIH0KCiAgICByZXR1cm4ga2V5czsKICB9CgogIGZ1bmN0aW9uIF9vYmplY3RTcHJlYWQyKHRhcmdldCkgewogICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsKICAgICAgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpXSAhPSBudWxsID8gYXJndW1lbnRzW2ldIDoge307CgogICAgICBpZiAoaSAlIDIpIHsKICAgICAgICBvd25LZXlzKE9iamVjdChzb3VyY2UpLCB0cnVlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICAgIF9kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgc291cmNlW2tleV0pOwogICAgICAgIH0pOwogICAgICB9IGVsc2UgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKSB7CiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhzb3VyY2UpKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBvd25LZXlzKE9iamVjdChzb3VyY2UpKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihzb3VyY2UsIGtleSkpOwogICAgICAgIH0pOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHRhcmdldDsKICB9CgogIGZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgewogICAgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSAiZnVuY3Rpb24iICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsKICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24iKTsKICAgIH0KCiAgICBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsKICAgICAgY29uc3RydWN0b3I6IHsKICAgICAgICB2YWx1ZTogc3ViQ2xhc3MsCiAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlCiAgICAgIH0KICAgIH0pOwogICAgaWYgKHN1cGVyQ2xhc3MpIF9zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcyk7CiAgfQoKICBmdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgewogICAgX2dldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LmdldFByb3RvdHlwZU9mIDogZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsKICAgICAgcmV0dXJuIG8uX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihvKTsKICAgIH07CiAgICByZXR1cm4gX2dldFByb3RvdHlwZU9mKG8pOwogIH0KCiAgZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsKICAgIF9zZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCBmdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgewogICAgICBvLl9fcHJvdG9fXyA9IHA7CiAgICAgIHJldHVybiBvOwogICAgfTsKCiAgICByZXR1cm4gX3NldFByb3RvdHlwZU9mKG8sIHApOwogIH0KCiAgZnVuY3Rpb24gX2lzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCgpIHsKICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gInVuZGVmaW5lZCIgfHwgIVJlZmxlY3QuY29uc3RydWN0KSByZXR1cm4gZmFsc2U7CiAgICBpZiAoUmVmbGVjdC5jb25zdHJ1Y3Quc2hhbSkgcmV0dXJuIGZhbHNlOwogICAgaWYgKHR5cGVvZiBQcm94eSA9PT0gImZ1bmN0aW9uIikgcmV0dXJuIHRydWU7CgogICAgdHJ5IHsKICAgICAgRGF0ZS5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChSZWZsZWN0LmNvbnN0cnVjdChEYXRlLCBbXSwgZnVuY3Rpb24gKCkge30pKTsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9IGNhdGNoIChlKSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZikgewogICAgaWYgKHNlbGYgPT09IHZvaWQgMCkgewogICAgICB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZCIpOwogICAgfQoKICAgIHJldHVybiBzZWxmOwogIH0KCiAgZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgewogICAgaWYgKGNhbGwgJiYgKF90eXBlb2YoY2FsbCkgPT09ICJvYmplY3QiIHx8IHR5cGVvZiBjYWxsID09PSAiZnVuY3Rpb24iKSkgewogICAgICByZXR1cm4gY2FsbDsKICAgIH0KCiAgICByZXR1cm4gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKTsKICB9CgogIGZ1bmN0aW9uIF9jcmVhdGVTdXBlcihEZXJpdmVkKSB7CiAgICB2YXIgaGFzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCA9IF9pc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QoKTsKCiAgICByZXR1cm4gZnVuY3Rpb24gX2NyZWF0ZVN1cGVySW50ZXJuYWwoKSB7CiAgICAgIHZhciBTdXBlciA9IF9nZXRQcm90b3R5cGVPZihEZXJpdmVkKSwKICAgICAgICAgIHJlc3VsdDsKCiAgICAgIGlmIChoYXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0KSB7CiAgICAgICAgdmFyIE5ld1RhcmdldCA9IF9nZXRQcm90b3R5cGVPZih0aGlzKS5jb25zdHJ1Y3RvcjsKCiAgICAgICAgcmVzdWx0ID0gUmVmbGVjdC5jb25zdHJ1Y3QoU3VwZXIsIGFyZ3VtZW50cywgTmV3VGFyZ2V0KTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXN1bHQgPSBTdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgcmVzdWx0KTsKICAgIH07CiAgfQoKICBmdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkkMShvYmosIGtleSwgdmFsdWUpIHsKICAgIGlmIChrZXkgaW4gb2JqKSB7CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgewogICAgICAgIHZhbHVlOiB2YWx1ZSwKICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICB3cml0YWJsZTogdHJ1ZQogICAgICB9KTsKICAgIH0gZWxzZSB7CiAgICAgIG9ialtrZXldID0gdmFsdWU7CiAgICB9CgogICAgcmV0dXJuIG9iajsKICB9CgogIGZ1bmN0aW9uIG93bktleXMkMShvYmplY3QsIGVudW1lcmFibGVPbmx5KSB7CiAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG9iamVjdCk7CgogICAgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHsKICAgICAgdmFyIHN5bWJvbHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKG9iamVjdCk7CiAgICAgIGlmIChlbnVtZXJhYmxlT25seSkgc3ltYm9scyA9IHN5bWJvbHMuZmlsdGVyKGZ1bmN0aW9uIChzeW0pIHsKICAgICAgICByZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHN5bSkuZW51bWVyYWJsZTsKICAgICAgfSk7CiAgICAgIGtleXMucHVzaC5hcHBseShrZXlzLCBzeW1ib2xzKTsKICAgIH0KCiAgICByZXR1cm4ga2V5czsKICB9CgogIGZ1bmN0aW9uIF9vYmplY3RTcHJlYWQyJDEodGFyZ2V0KSB7CiAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgewogICAgICB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldICE9IG51bGwgPyBhcmd1bWVudHNbaV0gOiB7fTsKCiAgICAgIGlmIChpICUgMikgewogICAgICAgIG93bktleXMkMShPYmplY3Qoc291cmNlKSwgdHJ1ZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgICBfZGVmaW5lUHJvcGVydHkkMSh0YXJnZXQsIGtleSwgc291cmNlW2tleV0pOwogICAgICAgIH0pOwogICAgICB9IGVsc2UgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKSB7CiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhzb3VyY2UpKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBvd25LZXlzJDEoT2JqZWN0KHNvdXJjZSkpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHNvdXJjZSwga2V5KSk7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gdGFyZ2V0OwogIH0KICAvKiBlc2xpbnQtZGlzYWJsZSBuby1lbXB0eSAqLwoKICAvKiBlc2xpbnQtZGlzYWJsZSBuby11bmRlZiAqLwoKCiAgdmFyIHRvU3RyaW5nID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZzsKCiAgZnVuY3Rpb24gaXNQbGFpbk9iamVjdCh0YXJnZXQpIHsKICAgIHJldHVybiB0b1N0cmluZy5jYWxsKHRhcmdldCkgPT09ICdbb2JqZWN0IE9iamVjdF0nOwogIH0KCiAgZnVuY3Rpb24gaXNTdHJpbmcodGFyZ2V0KSB7CiAgICByZXR1cm4gdG9TdHJpbmcuY2FsbCh0YXJnZXQpID09PSAnW29iamVjdCBTdHJpbmddJzsKICB9CgogIGZ1bmN0aW9uIGlzQXJyYXkodGFyZ2V0KSB7CiAgICByZXR1cm4gdG9TdHJpbmcuY2FsbCh0YXJnZXQpID09PSAnW29iamVjdCBBcnJheV0nOwogIH0KCiAgZnVuY3Rpb24gaXNFbXB0eU9iamVjdCh0YXJnZXQpIHsKICAgIGlmICghaXNQbGFpbk9iamVjdCh0YXJnZXQpKSByZXR1cm4gZmFsc2U7CiAgICByZXR1cm4gT2JqZWN0LmtleXModGFyZ2V0KS5sZW5ndGggPiAwOwogIH0KCiAgZnVuY3Rpb24gaXNCb29sZWFuKHRhcmdldCkgewogICAgcmV0dXJuIHRvU3RyaW5nLmNhbGwodGFyZ2V0KSA9PT0gJ1tvYmplY3QgQm9vbGVhbl0nOwogIH0KCiAgZnVuY3Rpb24gaXNGdW5jdGlvbih0YXJnZXQpIHsKICAgIHJldHVybiB0eXBlb2YgdGFyZ2V0ID09PSAnZnVuY3Rpb24nOwogIH0KCiAgZnVuY3Rpb24gaXNOdW1iZXIodGFyZ2V0KSB7CiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcmVzdHJpY3RlZC1nbG9iYWxzCiAgICByZXR1cm4gdG9TdHJpbmcuY2FsbCh0YXJnZXQpID09PSAnW29iamVjdCBOdW1iZXJdJyAmJiAhaXNOYU4odGFyZ2V0KTsKICB9CgogIGZ1bmN0aW9uIGlzUHJvbWlzZShvYmplY3QpIHsKICAgIGlmIChQcm9taXNlICYmIFByb21pc2UucmVzb2x2ZSkgewogICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG9iamVjdCkgPT0gb2JqZWN0OwogICAgfQogIH0KCiAgZnVuY3Rpb24gZXh0ZW5kKHRhcmdldCwgc291cmNlKSB7CiAgICByZXR1cm4gX29iamVjdFNwcmVhZDIkMShfb2JqZWN0U3ByZWFkMiQxKHt9LCB0YXJnZXQpLCBzb3VyY2UpOwogIH0KCiAgZnVuY3Rpb24gZ2V0QWdlbnQoKSB7CiAgICB0cnkgewogICAgICBpZiAod2luZG93ICYmIHdpbmRvdy5oaXN0b3J5KSB7CiAgICAgICAgcmV0dXJuICdXRUJfQVBQJzsKICAgICAgfQoKICAgICAgaWYgKHd4KSB7CiAgICAgICAgcmV0dXJuICdXWF9NSU5JX0FQUCc7CiAgICAgIH0KCiAgICAgIGlmIChzd2FuKSB7CiAgICAgICAgcmV0dXJuICdCQUlEVV9NSU5JX0FQUCc7CiAgICAgIH0KCiAgICAgIGlmIChteSkgewogICAgICAgIHJldHVybiAnQUxJUEFZX01JTklfQVBQJzsKICAgICAgfQoKICAgICAgaWYgKHR0KSB7CiAgICAgICAgcmV0dXJuICdUVF9NSU5JX0FQUCc7CiAgICAgIH0KCiAgICAgIGlmIChxcSkgewogICAgICAgIHJldHVybiAnUVFfTUlOSV9BUFAnOwogICAgICB9CgogICAgICBpZiAocXVpY2spIHsKICAgICAgICByZXR1cm4gJ1FVSUNLX0FQUCc7CiAgICAgIH0KICAgIH0gY2F0Y2ggKGVycikgewogICAgICByZXR1cm4gJ1VOS05PV05fQVBQJzsKICAgIH0KICB9CgogIGZ1bmN0aW9uIGdldEdsb2JhbCgpIHsKICAgIHRyeSB7CiAgICAgIGlmICh3aW5kb3cgJiYgd2luZG93Lmhpc3RvcnkpIHsKICAgICAgICByZXR1cm4gd2luZG93OwogICAgICB9CgogICAgICBpZiAod3gpIHsKICAgICAgICByZXR1cm4gd3g7CiAgICAgIH0KCiAgICAgIGlmIChzd2FuKSB7CiAgICAgICAgcmV0dXJuIHN3YW47CiAgICAgIH0KCiAgICAgIGlmIChteSkgewogICAgICAgIHJldHVybiBteTsKICAgICAgfQoKICAgICAgaWYgKHR0KSB7CiAgICAgICAgcmV0dXJuIHR0OwogICAgICB9CgogICAgICBpZiAocXEpIHsKICAgICAgICByZXR1cm4gcXE7CiAgICAgIH0KICAgIH0gY2F0Y2ggKGVycikgewogICAgICByZXR1cm4ge307CiAgICB9CiAgfQoKICBmdW5jdGlvbiBnZXRTeXN0ZW1JbmZvKCkgewogICAgLy8g6L+Z6YeM5YGa5Liq57yT5a2YCiAgICB2YXIgZ2xvYmFsT2JqID0gZ2V0R2xvYmFsKCk7CiAgICB2YXIga2V5ID0gJ19fc25pcGVyX19pbnRlcm5hbF9fZGF0YV9fJzsKCiAgICBpZiAoZ2xvYmFsT2JqW2tleV0gJiYgIWlzRW1wdHlPYmplY3QoZ2xvYmFsT2JqW2tleV0uc3lzdGVtSW5mbyB8fCB7fSkpIHsKICAgICAgcmV0dXJuIGdsb2JhbE9ialtrZXldLnN5c3RlbUluZm87CiAgICB9CgogICAgdHJ5IHsKICAgICAgdmFyIHN5c3RlbUluZm8gPSBnbG9iYWxPYmouZ2V0U3lzdGVtSW5mb1N5bmMoKTsKICAgICAgZ2xvYmFsT2JqW2tleV0gPSBnbG9iYWxPYmpba2V5XSB8fCB7fTsKICAgICAgZ2xvYmFsT2JqW2tleV0uc3lzdGVtSW5mbyA9IHN5c3RlbUluZm87CiAgICAgIHJldHVybiBzeXN0ZW1JbmZvOwogICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgIHJldHVybiB7fTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIGdldE1ldGEoKSB7CiAgICByZXR1cm4gewogICAgICBhZ2VudDogZ2V0QWdlbnQoKSwKICAgICAgc3lzdGVtOiBPYmplY3QuYXNzaWduKHt9LCBnZXRTeXN0ZW1JbmZvKCkpCiAgICB9OwogIH0KCiAgZnVuY3Rpb24gX2RlZmluZVByb3BlcnR5JDIob2JqLCBrZXksIHZhbHVlKSB7CiAgICBpZiAoa2V5IGluIG9iaikgewogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHsKICAgICAgICB2YWx1ZTogdmFsdWUsCiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgd3JpdGFibGU6IHRydWUKICAgICAgfSk7CiAgICB9IGVsc2UgewogICAgICBvYmpba2V5XSA9IHZhbHVlOwogICAgfQoKICAgIHJldHVybiBvYmo7CiAgfQoKICBmdW5jdGlvbiBvd25LZXlzJDIob2JqZWN0LCBlbnVtZXJhYmxlT25seSkgewogICAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhvYmplY3QpOwoKICAgIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7CiAgICAgIHZhciBzeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhvYmplY3QpOwogICAgICBpZiAoZW51bWVyYWJsZU9ubHkpIHN5bWJvbHMgPSBzeW1ib2xzLmZpbHRlcihmdW5jdGlvbiAoc3ltKSB7CiAgICAgICAgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBzeW0pLmVudW1lcmFibGU7CiAgICAgIH0pOwogICAgICBrZXlzLnB1c2guYXBwbHkoa2V5cywgc3ltYm9scyk7CiAgICB9CgogICAgcmV0dXJuIGtleXM7CiAgfQoKICBmdW5jdGlvbiBfb2JqZWN0U3ByZWFkMiQyKHRhcmdldCkgewogICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsKICAgICAgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpXSAhPSBudWxsID8gYXJndW1lbnRzW2ldIDoge307CgogICAgICBpZiAoaSAlIDIpIHsKICAgICAgICBvd25LZXlzJDIoT2JqZWN0KHNvdXJjZSksIHRydWUpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgICAgX2RlZmluZVByb3BlcnR5JDIodGFyZ2V0LCBrZXksIHNvdXJjZVtrZXldKTsKICAgICAgICB9KTsKICAgICAgfSBlbHNlIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycykgewogICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMoc291cmNlKSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgb3duS2V5cyQyKE9iamVjdChzb3VyY2UpKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihzb3VyY2UsIGtleSkpOwogICAgICAgIH0pOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHRhcmdldDsKICB9CgogIGZ1bmN0aW9uIHRocm93RXJyKGVycikgewogICAgdGhyb3cgbmV3IEVycm9yKGVycik7CiAgfQoKICB2YXIgc3RyYXRlZ2llcyA9IHsKICAgIHVybDogewogICAgICB2YWxpZGF0ZTogZnVuY3Rpb24gdmFsaWRhdGUodmFsKSB7CiAgICAgICAgaWYgKCF2YWwpIHsKICAgICAgICAgIHRocm93RXJyKHRoaXMubXNnUmVxdXJlZCk7CiAgICAgICAgfQogICAgICB9LAogICAgICBtc2dSZXF1cmVkOiAnU05JUEVSIEVSUk9SOiDphY3nva7kuK0gdXJsIOWtl+auteW/heWhqy4nCiAgICB9LAogICAgYXBwVmVyc2lvbjogewogICAgICB2YWxpZGF0ZTogZnVuY3Rpb24gdmFsaWRhdGUodmFsKSB7CiAgICAgICAgaWYgKCF2YWwpIHJldHVybjsKCiAgICAgICAgaWYgKCFpc1N0cmluZyh2YWwpKSB7CiAgICAgICAgICB0aHJvd0Vycih0aGlzLm1zZ1R5cGVFcnIpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgbXNnVHlwZUVycjogJ1NOSVBFUiBFUlJPUjog6YWN572u5LitIGFwcFZlcnNpb24g5a2X5q6157G75Z6L6ZyA5Li6IFN0cmluZy4nCiAgICB9LAogICAgZW52OiB7CiAgICAgIHZhbGlkYXRlOiBmdW5jdGlvbiB2YWxpZGF0ZSh2YWwpIHsKICAgICAgICBpZiAoIXZhbCkgcmV0dXJuOwoKICAgICAgICBpZiAoIWlzU3RyaW5nKHZhbCkpIHsKICAgICAgICAgIHRocm93RXJyKHRoaXMubXNnVHlwZUVycik7CiAgICAgICAgfQogICAgICB9LAogICAgICBtc2dUeXBlRXJyOiAnU05JUEVSIEVSUk9SOiDphY3nva7kuK0gZW52IOWtl+auteexu+Wei+mcgOS4uiBTdHJpbmcuJwogICAgfSwKICAgIHJlcGVhdDogewogICAgICB2YWxpZGF0ZTogZnVuY3Rpb24gdmFsaWRhdGUodmFsKSB7CiAgICAgICAgaWYgKCFpc051bWJlcih2YWwpKSB7CiAgICAgICAgICB0aHJvd0Vycih0aGlzLm1zZ1R5cGVFcnIpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgbXNnVHlwZUVycjogJ1NOSVBFUiBFUlJPUjog6YWN572u5LitIHJlcGVhdCDlrZfmrrXnsbvlnovpnIDkuLogTnVtYmVyLicKICAgIH0sCiAgICBpZ25vcmVFcnJvcnM6IHsKICAgICAgdmFsaWRhdGU6IGZ1bmN0aW9uIHZhbGlkYXRlKHZhbCkgewogICAgICAgIGlmICghaXNBcnJheSh2YWwpKSB7CiAgICAgICAgICB0aHJvd0Vycih0aGlzLm1zZ1R5cGVFcnIpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgbXNnVHlwZUVycjogJ1NOSVBFUiBFUlJPUjog6YWN572u5LitIGlnbm9yZUVycm9ycyDlrZfmrrXnsbvlnovpnIDkuLogQXJyYXkuJwogICAgfSwKICAgIGF1dG9CcmVhZGNydW1iczogewogICAgICB2YWxpZGF0ZTogZnVuY3Rpb24gdmFsaWRhdGUodmFsKSB7CiAgICAgICAgaWYgKCFpc0Jvb2xlYW4odmFsKSkgewogICAgICAgICAgdGhyb3dFcnIodGhpcy5tc2dUeXBlRXJyKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIG1zZ1R5cGVFcnI6ICdTTklQRVIgRVJST1I6IOmFjee9ruS4rSBhdXRvQnJlYWRjcnVtYnMg5a2X5q6157G75Z6L6ZyA5Li6IEFycmF5LicKICAgIH0sCiAgICBicmVhZGNydW1ic01heDogewogICAgICB2YWxpZGF0ZTogZnVuY3Rpb24gdmFsaWRhdGUodmFsKSB7CiAgICAgICAgaWYgKCFpc051bWJlcih2YWwpKSB7CiAgICAgICAgICB0aHJvd0Vycih0aGlzLm1zZ1R5cGVFcnIpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgbXNnVHlwZUVycjogJ1NOSVBFUiBFUlJPUjog6YWN572u5LitIGJyZWFkY3J1bWJzTWF4IOWtl+auteexu+Wei+mcgOS4uiBOdW1iZXIuJwogICAgfSwKICAgIHJhbmRvbTogewogICAgICB2YWxpZGF0ZTogZnVuY3Rpb24gdmFsaWRhdGUodmFsKSB7CiAgICAgICAgaWYgKCFpc051bWJlcih2YWwpKSB7CiAgICAgICAgICB0aHJvd0Vycih0aGlzLm1zZ1R5cGVFcnIpOwogICAgICAgIH0gZWxzZSBpZiAoISh2YWwgPiAwICYmIHZhbCA8PSAxKSkgewogICAgICAgICAgdGhyb3dFcnIodGhpcy5tc2dSYW5nZUVycik7CiAgICAgICAgfQogICAgICB9LAogICAgICBtc2dUeXBlRXJyOiAnU05JUEVSIEVSUk9SOiDphY3nva7kuK0gYnJlYWRjcnVtYnNNYXgg5a2X5q6157G75Z6L6ZyA5Li6IE51bWJlci4nLAogICAgICBtc2dSYW5nZUVycjogJ1NOSVBFUiBFUlJPUjog6YWN572u5LitIGJyZWFkY3J1bWJzTWF4IOWtl+auteiMg+WbtOmcgOa7oei2syAoMCwgMV0nCiAgICB9LAogICAgZGVsYXk6IHsKICAgICAgdmFsaWRhdGU6IGZ1bmN0aW9uIHZhbGlkYXRlKHZhbCkgewogICAgICAgIGlmICghaXNOdW1iZXIodmFsKSkgewogICAgICAgICAgdGhyb3dFcnIodGhpcy5tc2dUeXBlRXJyKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIG1zZ1R5cGVFcnI6ICdTTklQRVIgRVJST1I6IOmFjee9ruS4rSBkZWxheSDlrZfmrrXnsbvlnovpnIDkuLogTnVtYmVyLicKICAgIH0sCiAgICBiZWZvcmVSZXBvcnQ6IHsKICAgICAgdmFsaWRhdGU6IGZ1bmN0aW9uIHZhbGlkYXRlKHZhbCkgewogICAgICAgIGlmICghaXNGdW5jdGlvbih2YWwpKSB7CiAgICAgICAgICB0aHJvd0Vycih0aGlzLm1zZ1R5cGVFcnIpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgbXNnVHlwZUVycjogJ1NOSVBFUiBFUlJPUjog6YWN572u5LitIGJlZm9yZVJlcG9ydCDlrZfmrrXnsbvlnovpnIDkuLogRnVuY3Rpb24uJwogICAgfQogIH07CgogIGZ1bmN0aW9uIHByb3h5VmFsaWRhdGUoKSB7CiAgICB2YXIgcHJveHlPYmogPSB7fTsKICAgIHJldHVybiBuZXcgUHJveHkocHJveHlPYmosIHsKICAgICAgc2V0OiBmdW5jdGlvbiBzZXQodGFyZ2V0LCBrZXksIHZhbCkgewogICAgICAgIHN0cmF0ZWdpZXNba2V5XS52YWxpZGF0ZSh2YWwpOyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcGFyYW0tcmVhc3NpZ24KCiAgICAgICAgdGFyZ2V0W2tleV0gPSB2YWw7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KICAgIH0pOwogIH0KCiAgZnVuY3Rpb24gdmFsaWRhdGVDb25maWcoY29uZmlnKSB7CiAgICB2YXIgcHJveHkgPSBwcm94eVZhbGlkYXRlKCk7CiAgICBPYmplY3Qua2V5cyhjb25maWcpLmZvckVhY2goZnVuY3Rpb24gKHByb3ApIHsKICAgICAgcHJveHlbcHJvcF0gPSBjb25maWdbcHJvcF07CiAgICB9KTsKICB9CgogIHZhciBCZWhhdmlvclJlcG9ydGVyID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICAgIGZ1bmN0aW9uIEJlaGF2aW9yUmVwb3J0ZXIoKSB7CiAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBCZWhhdmlvclJlcG9ydGVyKTsKCiAgICAgIHRoaXMubG9nUXVldWUgPSBbXTsKICAgICAgdGhpcy5jb25maWcgPSB7CiAgICAgICAgdXJsOiAnJywKICAgICAgICBhcHBrZXk6ICcnLAogICAgICAgIC8vIOS7peWQjuWVhuS4muWMluimgeeUqOWIsOeahAogICAgICAgIGRlbGF5OiAxMDAwLAogICAgICAgIC8vIOW7tui/nywg5ZCI5bm25LiK5oqlCiAgICAgICAgYXBwVmVyc2lvbjogJycsCiAgICAgICAgLy8g5bqU55SoVmVyc2lvbgogICAgICAgIGVudjogJycsCiAgICAgICAgLy8g546v5aKDCiAgICAgICAgYmVmb3JlUmVwb3J0OiBmdW5jdGlvbiBiZWZvcmVSZXBvcnQobG9nKSB7CiAgICAgICAgICAvLyAxLuWPr+WcqOi/memHjOWKq+aMgeS4iuaKpeeahOaVsOaNriwg5q+U5aaC5re75YqgdXNlcmlkLCBzZXNzaW9u562J562JCiAgICAgICAgICAvLyAyLuWmguaenHJldHVybiBmYWxzZSwg5YiZ5LiN55So5YaF572uaHR0cOS4iuaKpSwg5q2k5pe25Y+v5Lul5Zyo6L+Z6YeM6Ieq5a6a5LmJ6Ieq5bex55qEaHR0cOS4iuaKpeaWueW8jwogICAgICAgICAgLy8gICDmr5TlpoLku6XlkI7mtY/op4jlmajnq6/vvIzlj6/ku6Xoh6rlrprkuYkgYWpheCDkuIrmiqXov5jmmK/nlKjlm77niYfkuIrmiqUKICAgICAgICAgIHJldHVybiBsb2c7CiAgICAgICAgfQogICAgICB9OwogICAgICB0aGlzLmFwcGx5UmVxdWVzdGVkID0gZmFsc2U7CiAgICAgIHRoaXMuZGVsYXlUaW1lciA9IC0xOwogICAgfQoKICAgIF9jcmVhdGVDbGFzcyhCZWhhdmlvclJlcG9ydGVyLCBbewogICAgICBrZXk6ICJtZXJnZUNvbmZpZyIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBtZXJnZUNvbmZpZyhvcHRzKSB7CiAgICAgICAgdmFsaWRhdGVDb25maWcob3B0cyk7CiAgICAgICAgdGhpcy5jb25maWcgPSBleHRlbmQodGhpcy5jb25maWcsIG9wdHMpOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImFkZExvZyIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBhZGRMb2cobG9nKSB7CiAgICAgICAgdGhpcy5sb2dRdWV1ZS5wdXNoKGxvZyk7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAiZ2V0TG9nIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldExvZygpIHsKICAgICAgICByZXR1cm4gdGhpcy5sb2dRdWV1ZS5zbGljZSgpOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImNsZWFyTG9nIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNsZWFyTG9nKCkgewogICAgICAgIHRoaXMubG9nUXVldWUgPSBbXTsKICAgICAgICByZXR1cm4gdGhpczsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJyZXBvcnQiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gcmVwb3J0KCkgewogICAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgICB2YXIgY3VyTG9nUXVldWUgPSB0aGlzLmdldExvZygpOwoKICAgICAgICBpZiAodGhpcy5jb25maWcuZGVsYXkgPiAwKSB7CiAgICAgICAgICBpZiAodGhpcy5kZWxheVRpbWVyKSB7CiAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLmRlbGF5VGltZXIpOwogICAgICAgICAgfQoKICAgICAgICAgIHRoaXMuZGVsYXlUaW1lciA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICBfdGhpczIuc2VuZExvZyhjdXJMb2dRdWV1ZSk7CiAgICAgICAgICB9LCB0aGlzLmNvbmZpZy5kZWxheSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuc2VuZExvZyhjdXJMb2dRdWV1ZSk7CiAgICAgICAgfQogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImdMb2ciLAogICAgICB2YWx1ZTogZnVuY3Rpb24gZ0xvZyhsb2cpIHsKICAgICAgICB2YXIgX3RoaXMkY29uZmlnID0gdGhpcy5jb25maWcsCiAgICAgICAgICAgIGFwcFZlcnNpb24gPSBfdGhpcyRjb25maWcuYXBwVmVyc2lvbiwKICAgICAgICAgICAgZW52ID0gX3RoaXMkY29uZmlnLmVudjsKICAgICAgICByZXR1cm4gX29iamVjdFNwcmVhZDIkMihfb2JqZWN0U3ByZWFkMiQyKHt9LCBnZXRNZXRhKCkpLCB7fSwgewogICAgICAgICAgYXBwVmVyc2lvbjogYXBwVmVyc2lvbiwKICAgICAgICAgIGVudjogZW52LAogICAgICAgICAgbG9nczogbG9nCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAic2VuZExvZyIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBzZW5kTG9nKCkgewogICAgICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgICAgICB2YXIgbG9nUXVldWUgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IFtdOwogICAgICAgIHZhciBsb2cgPSBsb2dRdWV1ZS5zbGljZSgpOwogICAgICAgIGlmICghbG9nLmxlbmd0aCkgcmV0dXJuOwogICAgICAgIHZhciBkYXRhID0gdGhpcy5nTG9nKGxvZyk7CiAgICAgICAgdmFyIHJldCA9IGlzRnVuY3Rpb24odGhpcy5jb25maWcuYmVmb3JlUmVwb3J0KSAmJiB0aGlzLmNvbmZpZy5iZWZvcmVSZXBvcnQuY2FsbCh0aGlzLCBkYXRhKTsgLy8g5byC5q2l5Zue6LCDCgogICAgICAgIGlmIChpc1Byb21pc2UocmV0KSkgewogICAgICAgICAgcmV0LnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgICBpZiAoaXNCb29sZWFuKHJlcykgJiYgcmVzID09PSBmYWxzZSkgewogICAgICAgICAgICAgIC8vIOeUqOaIt+mYu+atoum7mOiupOS4iuaKpeWQju+8jOWPr+WcqCBiZWZvcmVSZXBvcnQg5Y+v6Ieq5a6a5LmJIHJlcXVlc3Qg5LiK5oqlCiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgICBfdGhpczMuc3RhcnRSZXBvcnQocmVzKTsKICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBpZiAoaXNCb29sZWFuKHJldCkgJiYgcmV0ID09PSBmYWxzZSkgewogICAgICAgICAgICAvLyDnlKjmiLfpmLvmraLpu5jorqTkuIrmiqXlkI7vvIzlj6/lnKggYmVmb3JlUmVwb3J0IOWPr+iHquWumuS5iSByZXF1ZXN0IOS4iuaKpQogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CgogICAgICAgICAgdGhpcy5zdGFydFJlcG9ydChyZXQpOwogICAgICAgIH0KICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJzdGFydFJlcG9ydCIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBzdGFydFJlcG9ydChkYXRhKSB7CiAgICAgICAgdGhpcy5jbGVhckxvZygpOyAvLyDpu5jorqTkuIrmiqUKCiAgICAgICAgdGhpcy5yZXF1ZXN0KHsKICAgICAgICAgIHVybDogdGhpcy5jb25maWcudXJsLAogICAgICAgICAgbWV0aG9kOiAnUE9TVCcsCiAgICAgICAgICBkYXRhOiBkYXRhCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAidXNlIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIHVzZShwbHVnaW4pIHsKICAgICAgICBmb3IgKHZhciBfbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShfbGVuID4gMSA/IF9sZW4gLSAxIDogMCksIF9rZXkgPSAxOyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7CiAgICAgICAgICBhcmdzW19rZXkgLSAxXSA9IGFyZ3VtZW50c1tfa2V5XTsKICAgICAgICB9CgogICAgICAgIHBsdWdpbi5pbml0LmFwcGx5KHBsdWdpbiwgW3RoaXNdLmNvbmNhdChhcmdzKSk7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAiYXBwbHlSZXF1ZXN0IiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIGFwcGx5UmVxdWVzdChyZXF1ZXN0KSB7CiAgICAgICAgaWYgKHRoaXMuYXBwbHlSZXF1ZXN0ZWQpIHJldHVybiBmYWxzZTsKICAgICAgICB0aGlzLnJlcXVlc3QgPSByZXF1ZXN0OwogICAgICAgIHRoaXMuYXBwbHlSZXF1ZXN0ZWQgPSB0cnVlOwogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CiAgICB9XSk7CgogICAgcmV0dXJuIEJlaGF2aW9yUmVwb3J0ZXI7CiAgfSgpOwoKICB2YXIgcGFyc2VSZXBvcnRMb2cgPSBmdW5jdGlvbiBwYXJzZVJlcG9ydExvZyhsaXN0KSB7CiAgICB2YXIgYXJyID0gWytuZXcgRGF0ZSgpLCAnd2ViJywgJ2g1J107CiAgICByZXR1cm4gYXJyLmNvbmNhdChsaXN0KS5qb2luKCcqJyk7CiAgfTsKCiAgdmFyIGdldEVsbVBhdGggPSBmdW5jdGlvbiBnZXRFbG1QYXRoKGUpIHsKICAgIHZhciBtYXhEZWVwID0gNTsKICAgIGlmICghZSB8fCAxICE9PSBlLm5vZGVUeXBlKSByZXR1cm4gJyc7CiAgICB2YXIgcmV0ID0gW10sCiAgICAgICAgZGVlcExlbmd0aCA9IDAsCiAgICAgICAgZWxtID0gJyc7CiAgICByZXQucHVzaCgiKCIuY29uY2F0KGUuaW5uZXJUZXh0LnN1YnN0cigwLCA1MCksICIpIikpOwoKICAgIGZvciAodmFyIHQgPSBlIHx8IG51bGw7IHQgJiYgZGVlcExlbmd0aCsrIDwgbWF4RGVlcCAmJiAhKCdodG1sJyA9PT0gKGVsbSA9IG5vcm1hbFRhcmdldCh0KSkpOykgewogICAgICByZXQucHVzaChlbG0pLCB0ID0gdC5wYXJlbnROb2RlOwogICAgfQoKICAgIHJldHVybiByZXQucmV2ZXJzZSgpLmpvaW4oJyA+ICcpOwogIH07CgogIHZhciBnZXRDb21tb25BdHRyaWJ1dGUgPSBmdW5jdGlvbiBnZXRDb21tb25BdHRyaWJ1dGUoKSB7CiAgICByZXR1cm4gewogICAgICB1cmw6IGVuY29kZVVSSUNvbXBvbmVudCh3aW5kb3cubG9jYXRpb24uaHJlZiksCiAgICAgIHRpbWU6ICtuZXcgRGF0ZSgpCiAgICB9OwogIH07CgogIHZhciBub3JtYWxUYXJnZXQgPSBmdW5jdGlvbiBub3JtYWxUYXJnZXQoZSkgewogICAgdmFyIHQsCiAgICAgICAgbiwKICAgICAgICByLAogICAgICAgIGEsCiAgICAgICAgaSwKICAgICAgICBvID0gW107CiAgICBpZiAoIWUgfHwgIWUudGFnTmFtZSkgcmV0dXJuICcnOwoKICAgIGlmIChvLnB1c2goZS50YWdOYW1lLnRvTG93ZXJDYXNlKCkpLCBlLmlkICYmIG8ucHVzaCgnIycuY29uY2F0KGUuaWQpKSwgKHQgPSBlLmNsYXNzTmFtZSkgJiYgJ1tvYmplY3QgU3RyaW5nXScgPT09IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh0KSkgewogICAgICBmb3IgKG4gPSB0LnNwbGl0KC9ccysvKSwgaSA9IDA7IGkgPCBuLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgLy8gY2xhc3NOYW1l5YyF5ZCrYWN0aXZl55qE5LiN5Yqg5YWl6Lev5b6ECiAgICAgICAgaWYgKG5baV0uaW5kZXhPZignYWN0aXZlJykgPCAwKSBvLnB1c2goJy4nLmNvbmNhdChuW2ldKSk7CiAgICAgIH0KICAgIH0KCiAgICB2YXIgcyA9IFsndHlwZScsICduYW1lJywgJ3RpdGxlJywgJ2FsdCcsICdzcmMnXTsKCiAgICBmb3IgKGkgPSAwOyBpIDwgcy5sZW5ndGg7IGkrKykgewogICAgICByID0gc1tpXSwgKGEgPSBlLmdldEF0dHJpYnV0ZShyKSkgJiYgby5wdXNoKCdbJy5jb25jYXQociwgJz0iJykuY29uY2F0KGEsICciXScpKTsKICAgIH0KCiAgICByZXR1cm4gby5qb2luKCcnKTsKICB9OwoKICBmdW5jdGlvbiB0aGVFdmVudEVycm9yKGVycm9yKSB7CiAgICAvLyBFcnJvckV2ZW50IOaNleiOt+W8guW4uCwgRXZlbnQg6LWE5rqQ6ZSZ6K+vCiAgICB2YXIgY29tbW9uQXR0ciA9IGdldENvbW1vbkF0dHJpYnV0ZSgpOwogICAgdmFyIG1zZyA9ICcnLAogICAgICAgIGVycmNvZGUgPSAnJzsKCiAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBFcnJvckV2ZW50KSB7CiAgICAgIG1zZyA9IGVycm9yLm1lc3NhZ2U7CiAgICAgIGVycmNvZGUgPSAnZXJyb3InOwogICAgfSBlbHNlIHsKICAgICAgdmFyIHRoZVBhdGggPSBnZXRFbG1QYXRoKGVycm9yLnRhcmdldCk7CiAgICAgIG1zZyA9ICfotYTmupDplJnor686ICcgKyB0aGVQYXRoOwogICAgICBlcnJjb2RlID0gJ3Jlc291cmNlX2Vycm9yJzsKICAgIH0KCiAgICB2YXIgZGF0YSA9IF9vYmplY3RTcHJlYWQyKF9vYmplY3RTcHJlYWQyKHt9LCBjb21tb25BdHRyKSwgewogICAgICBlcnJjb2RlOiBlcnJjb2RlLAogICAgICBlcnJtc2c6IG1zZwogICAgfSk7CgogICAgdmFyIGVyckxvZyA9IHBhcnNlUmVwb3J0TG9nKFsid2ViX2Vycm9yOiIuY29uY2F0KEpTT04uc3RyaW5naWZ5KGRhdGEpKV0pOwogICAgdGhpcy5hZGRMb2coZXJyTG9nKTsKICAgIHRoaXMucmVwb3J0KCk7CiAgfQoKICBmdW5jdGlvbiB0aGVFdmVudFVuaGFuZGxlZHJlamVjdGlvbihlKSB7CiAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICB2YXIgY29tbW9uQXR0ciA9IGdldENvbW1vbkF0dHJpYnV0ZSgpOwoKICAgIHZhciBkYXRhID0gX29iamVjdFNwcmVhZDIoX29iamVjdFNwcmVhZDIoe30sIGNvbW1vbkF0dHIpLCB7CiAgICAgIGVycmNvZGU6ICd1bmhhbmRsZWRyZWplY3Rpb24nLAogICAgICBlcnJtc2c6IGUucmVhc29uLnN0YWNrCiAgICB9KTsKCiAgICB2YXIgZXJyTG9nID0gcGFyc2VSZXBvcnRMb2coWyJ3ZWJfZXJyb3I6Ii5jb25jYXQoSlNPTi5zdHJpbmdpZnkoZGF0YSkpXSk7CiAgICB0aGlzLmFkZExvZyhlcnJMb2cpOwogICAgdGhpcy5yZXBvcnQoKTsKICB9CgogIGZ1bmN0aW9uIHRoZUV2ZW50Q2xpY2soZXZlbnQpIHsKICAgIHZhciB0YXJnZXQ7CgogICAgdHJ5IHsKICAgICAgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0OwogICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgIHRhcmdldCA9ICc8dW5rbm93bj4nOwogICAgfQoKICAgIGlmICh0YXJnZXQubm9kZU5hbWUgPT09ICdIVE1MJyB8fCB0YXJnZXQubm9kZU5hbWUgPT09ICdURVhUQVJFQScpIHJldHVybjsKICAgIGlmICh0YXJnZXQubGVuZ3RoID09PSAwKSByZXR1cm47CiAgICB2YXIgdGhlUGF0aCA9IGdldEVsbVBhdGgodGFyZ2V0KTsKICAgIGlmICghdGhlUGF0aCkgcmV0dXJuOwogICAgdmFyIGNvbnRlbnRUZXh0OwoKICAgIHN3aXRjaCAodGFyZ2V0Lm5vZGVOYW1lKSB7CiAgICAgIGNhc2UgJ0RJVic6CiAgICAgICAgY29udGVudFRleHQgPSB0YXJnZXQudGV4dENvbnRlbnQ7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICdJTUcnOgogICAgICAgIGNvbnRlbnRUZXh0ID0gdGFyZ2V0LnNyYzsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgJ0lOUFVUJzoKICAgICAgICBjb250ZW50VGV4dCA9IHRhcmdldC5kZWZhdWx0VmFsdWU7CiAgICAgICAgYnJlYWs7CgogICAgICBkZWZhdWx0OgogICAgICAgIGNvbnRlbnRUZXh0ID0gbnVsbDsKICAgIH0KCiAgICB2YXIgdXJsID0gZW5jb2RlVVJJQ29tcG9uZW50KHdpbmRvdy5sb2NhdGlvbi5ocmVmKTsKICAgIHZhciBjbGlja0xvZyA9IHBhcnNlUmVwb3J0TG9nKFsnY2xpY2snLCB0YXJnZXQuaWQgfHwgdGFyZ2V0LmNsYXNzTmFtZSwgIiIuY29uY2F0KHVybCwgIlx1RkYxQSIpLmNvbmNhdCh0aGVQYXRoKSwgY29udGVudFRleHRdKTsKICAgIHRoaXMuYWRkTG9nKGNsaWNrTG9nKTsKICAgIHRoaXMucmVwb3J0KCk7CiAgfQoKICBmdW5jdGlvbiB0aGVFdmVudEhhc2hjaGFuZ2UoZXZlbnQpIHsKICAgIHZhciBuZXdVUkwgPSBldmVudC5uZXdVUkwsCiAgICAgICAgb2xkVVJMID0gZXZlbnQub2xkVVJMOwogICAgdmFyIGhhc2hjaGFuZ2VMb2cgPSBwYXJzZVJlcG9ydExvZyhbJ3dlYl90bycsIGVuY29kZVVSSUNvbXBvbmVudChuZXdVUkwpLCBlbmNvZGVVUklDb21wb25lbnQob2xkVVJMKV0pOwogICAgdGhpcy5hZGRMb2coaGFzaGNoYW5nZUxvZyk7CiAgICB0aGlzLnJlcG9ydCgpOwogIH0KCiAgZnVuY3Rpb24gdGhlRXZlbnRVbmxvYWQoKSB7CiAgICB2YXIgdXJsID0gZW5jb2RlVVJJQ29tcG9uZW50KHdpbmRvdy5sb2NhdGlvbi5ocmVmKTsKICAgIHZhciBwYWdlRnJvbUxvZyA9IHBhcnNlUmVwb3J0TG9nKFsnd2ViX3RvJywgdXJsLCAndW5rbm93biddKTsKICAgIHRoaXMuYWRkTG9nKHBhZ2VGcm9tTG9nKTsKICAgIHRoaXMucmVwb3J0KCk7CiAgfQoKICBmdW5jdGlvbiB0aGVFdmVudEhpc3RvcnlzdGF0ZWNoYW5nZWQoZXZlbnQpIHsKICAgIHZhciB0YXJnZXQgPSBldmVudC50YXJnZXQ7CiAgICB2YXIgaGFzaGNoYW5nZUxvZyA9IHBhcnNlUmVwb3J0TG9nKFsnd2ViX3RvJywgJ3Vua25vdycsIGVuY29kZVVSSUNvbXBvbmVudCh0YXJnZXQubG9jYXRpb24uaHJlZildKTsKICAgIHRoaXMuYWRkTG9nKGhhc2hjaGFuZ2VMb2cpOwogICAgdGhpcy5yZXBvcnQoKTsKICB9CgogIHZhciBhZGRFdmVudExpc3RlbmVyID0gewogICAgaW5pdDogZnVuY3Rpb24gaW5pdChjb3JlKSB7CiAgICAgIC8vIOmhtemdouWKoOi9veWJjQogICAgICB2YXIgc3RhcnRMb2cgPSBwYXJzZVJlcG9ydExvZyhbIndlYl9zdGFydDogIi5jb25jYXQoSlNPTi5zdHJpbmdpZnkoZ2V0Q29tbW9uQXR0cmlidXRlKCkpKV0pOwogICAgICBjb3JlLmFkZExvZyhzdGFydExvZyk7CiAgICAgIGNvbnNvbGUubG9nKCdjb3JlLS0nLCBjb3JlLmxvZ1F1ZXVlKTsKICAgICAgY29yZS5yZXBvcnQoKTsKICAgICAgdmFyIGluaXRFdmVudCA9IHsKICAgICAgICAvL2xvYWQ6IHsgZm46IHRoZUV2ZW50TG9hZCB9LAogICAgICAgIGVycm9yOiB7CiAgICAgICAgICBmbjogdGhlRXZlbnRFcnJvcgogICAgICAgIH0sCiAgICAgICAgdW5oYW5kbGVkcmVqZWN0aW9uOiB7CiAgICAgICAgICBmbjogdGhlRXZlbnRVbmhhbmRsZWRyZWplY3Rpb24KICAgICAgICB9LAogICAgICAgIGNsaWNrOiB7CiAgICAgICAgICBmbjogdGhlRXZlbnRDbGljawogICAgICAgIH0sCiAgICAgICAgaGFzaGNoYW5nZTogewogICAgICAgICAgZm46IHRoZUV2ZW50SGFzaGNoYW5nZQogICAgICAgIH0sCiAgICAgICAgdW5sb2FkOiB7CiAgICAgICAgICBmbjogdGhlRXZlbnRVbmxvYWQKICAgICAgICB9LAogICAgICAgIGhpc3RvcnlzdGF0ZWNoYW5nZWQ6IHsKICAgICAgICAgIGZuOiB0aGVFdmVudEhpc3RvcnlzdGF0ZWNoYW5nZWQKICAgICAgICB9CiAgICAgIH07IC8vIOebkeWQrOWHveaVsOS4jeimgeS9v+eUqOWMv+WQjeWHveaVsCwg5Y+v5Lul5YeP5L2O5YaF5a2Y44CB6Ieq5Yqo5Zue5pS2CgogICAgICBPYmplY3Qua2V5cyhpbml0RXZlbnQpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIHZhciBldmVudCA9IGluaXRFdmVudFtrZXldOwogICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKGtleSwgZXZlbnQuZm4uYmluZChjb3JlKSwgdHJ1ZSk7CiAgICAgIH0pOwogICAgfQogIH07CgogIGZ1bmN0aW9uIFJlcXVlc3QoY29uZmlnKSB7CiAgICB2YXIgdXJsID0gY29uZmlnLnVybCwKICAgICAgICBtZXRob2QgPSBjb25maWcubWV0aG9kLAogICAgICAgIGRhdGEgPSBjb25maWcuZGF0YTsKICAgIHZhciB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTsKICAgIHhoci5vcGVuKG1ldGhvZCwgdXJsLCB0cnVlKTsKICAgIHhoci5zZXRSZXF1ZXN0SGVhZGVyKCdjb250ZW50LXR5cGUnLCAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkJyk7CiAgICB4aHIuc2VuZCgndWU9JyArIEpTT04uc3RyaW5naWZ5KGRhdGEpKTsKICAgIHJldHVybiB4aHI7CiAgfQoKICB2YXIgUmVwb3J0b3IgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9CZWhhdmlvclJlcG9ydGVyKSB7CiAgICBfaW5oZXJpdHMoUmVwb3J0b3IsIF9CZWhhdmlvclJlcG9ydGVyKTsKCiAgICB2YXIgX3N1cGVyID0gX2NyZWF0ZVN1cGVyKFJlcG9ydG9yKTsKCiAgICBmdW5jdGlvbiBSZXBvcnRvcigpIHsKICAgICAgdmFyIG9wdHMgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IHt9OwoKICAgICAgdmFyIF90aGlzOwoKICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFJlcG9ydG9yKTsKCiAgICAgIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgb3B0cyk7IC8vIOWQiOW5tuWPguaVsAoKICAgICAgX3RoaXMubWVyZ2VDb25maWcob3B0cyk7CgogICAgICBfdGhpcy5pbml0KCk7CgogICAgICByZXR1cm4gX3RoaXM7CiAgICB9CgogICAgX2NyZWF0ZUNsYXNzKFJlcG9ydG9yLCBbewogICAgICBrZXk6ICJpbml0IiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluaXQoKSB7CiAgICAgICAgLy8g5Yqr5oyBIEFwcCBvbkVycm9yCiAgICAgICAgdGhpcy51c2UoYWRkRXZlbnRMaXN0ZW5lcik7IC8vIHRoaXMudXNlKHBsdWdpbkhvb2tXZWIpOwogICAgICAgIC8vIC8vIOWKq+aMgSBSZXF1ZXN0CiAgICAgICAgLy8gdGhpcy51c2UocGx1Z2luSG9va1JxKTsKICAgICAgICAvLyB0aGlzLnVzZShwbHVnaW5QYXRjaFByb21pc2UpOwoKICAgICAgICB0aGlzLmFwcGx5UmVxdWVzdChSZXF1ZXN0KTsKICAgICAgfQogICAgfV0pOwoKICAgIHJldHVybiBSZXBvcnRvcjsKICB9KEJlaGF2aW9yUmVwb3J0ZXIpOwoKICByZXR1cm4gUmVwb3J0b3I7Cn0pOw=="},{"version":3,"sources":["/Users/qitmac001131/Desktop/test/sniperjs/packages/WebErrorReporter/dist/index.js"],"names":["global","factory","exports","module","define","amd","self","Sniperjs","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","_createClass","protoProps","staticProps","prototype","_defineProperty","obj","value","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","push","apply","_objectSpread2","arguments","source","forEach","getOwnPropertyDescriptors","defineProperties","_inherits","subClass","superClass","create","constructor","_setPrototypeOf","_getPrototypeOf","o","setPrototypeOf","getPrototypeOf","__proto__","p","_isNativeReflectConstruct","Reflect","construct","sham","Proxy","Date","toString","call","e","_assertThisInitialized","ReferenceError","_possibleConstructorReturn","_createSuper","Derived","hasNativeReflectConstruct","_createSuperInternal","Super","result","NewTarget","_defineProperty$1","ownKeys$1","_objectSpread2$1","isPlainObject","isString","isArray","isEmptyObject","isBoolean","isFunction","isNumber","isNaN","isPromise","Promise","resolve","extend","getAgent","window","history","wx","swan","my","tt","qq","quick","err","getGlobal","getSystemInfo","globalObj","systemInfo","getSystemInfoSync","getMeta","agent","system","assign","_defineProperty$2","ownKeys$2","_objectSpread2$2","throwErr","Error","strategies","url","validate","val","msgRequred","appVersion","msgTypeErr","env","repeat","ignoreErrors","autoBreadcrumbs","breadcrumbsMax","random","msgRangeErr","delay","beforeReport","proxyValidate","proxyObj","set","validateConfig","config","proxy","prop","BehaviorReporter","logQueue","appkey","log","applyRequested","delayTimer","mergeConfig","opts","addLog","getLog","slice","clearLog","report","curLogQueue","clearTimeout","setTimeout","sendLog","gLog","logs","data","ret","then","res","startReport","request","method","use","plugin","args","init","applyRequest","parseReportLog","list","arr","concat","join","getElmPath","maxDeep","nodeType","deepLength","elm","innerText","substr","t","normalTarget","parentNode","reverse","getCommonAttribute","encodeURIComponent","location","href","time","n","r","a","tagName","toLowerCase","id","className","split","indexOf","s","getAttribute","theEventError","error","commonAttr","msg","errcode","ErrorEvent","message","thePath","errmsg","errLog","JSON","stringify","theEventUnhandledrejection","preventDefault","reason","stack","theEventClick","event","nodeName","contentText","textContent","src","defaultValue","clickLog","theEventHashchange","newURL","oldURL","hashchangeLog","theEventUnload","pageFromLog","theEventHistorystatechanged","addEventListener","core","startLog","console","initEvent","fn","unhandledrejection","click","hashchange","unload","historystatechanged","bind","Request","xhr","XMLHttpRequest","open","setRequestHeader","send","Reportor","_BehaviorReporter","_super","_this"],"mappings":"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","sourcesContent":["(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  (global = global || self, global.Sniperjs = factory());\n}(this, (function () { 'use strict';\n\n  function _classCallCheck(instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n      throw new TypeError(\"Cannot call a class as a function\");\n    }\n  }\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  function _createClass(Constructor, protoProps, staticProps) {\n    if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) _defineProperties(Constructor, staticProps);\n    return Constructor;\n  }\n\n  function _defineProperty(obj, key, value) {\n    if (key in obj) {\n      Object.defineProperty(obj, key, {\n        value: value,\n        enumerable: true,\n        configurable: true,\n        writable: true\n      });\n    } else {\n      obj[key] = value;\n    }\n\n    return obj;\n  }\n\n  function ownKeys(object, enumerableOnly) {\n    var keys = Object.keys(object);\n\n    if (Object.getOwnPropertySymbols) {\n      var symbols = Object.getOwnPropertySymbols(object);\n      if (enumerableOnly) symbols = symbols.filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n      });\n      keys.push.apply(keys, symbols);\n    }\n\n    return keys;\n  }\n\n  function _objectSpread2(target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i] != null ? arguments[i] : {};\n\n      if (i % 2) {\n        ownKeys(Object(source), true).forEach(function (key) {\n          _defineProperty(target, key, source[key]);\n        });\n      } else if (Object.getOwnPropertyDescriptors) {\n        Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n      } else {\n        ownKeys(Object(source)).forEach(function (key) {\n          Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n        });\n      }\n    }\n\n    return target;\n  }\n\n  function _inherits(subClass, superClass) {\n    if (typeof superClass !== \"function\" && superClass !== null) {\n      throw new TypeError(\"Super expression must either be null or a function\");\n    }\n\n    subClass.prototype = Object.create(superClass && superClass.prototype, {\n      constructor: {\n        value: subClass,\n        writable: true,\n        configurable: true\n      }\n    });\n    if (superClass) _setPrototypeOf(subClass, superClass);\n  }\n\n  function _getPrototypeOf(o) {\n    _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n      return o.__proto__ || Object.getPrototypeOf(o);\n    };\n    return _getPrototypeOf(o);\n  }\n\n  function _setPrototypeOf(o, p) {\n    _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n      o.__proto__ = p;\n      return o;\n    };\n\n    return _setPrototypeOf(o, p);\n  }\n\n  function _isNativeReflectConstruct() {\n    if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n    if (Reflect.construct.sham) return false;\n    if (typeof Proxy === \"function\") return true;\n\n    try {\n      Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));\n      return true;\n    } catch (e) {\n      return false;\n    }\n  }\n\n  function _assertThisInitialized(self) {\n    if (self === void 0) {\n      throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n    }\n\n    return self;\n  }\n\n  function _possibleConstructorReturn(self, call) {\n    if (call && (typeof call === \"object\" || typeof call === \"function\")) {\n      return call;\n    }\n\n    return _assertThisInitialized(self);\n  }\n\n  function _createSuper(Derived) {\n    var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n    return function _createSuperInternal() {\n      var Super = _getPrototypeOf(Derived),\n          result;\n\n      if (hasNativeReflectConstruct) {\n        var NewTarget = _getPrototypeOf(this).constructor;\n\n        result = Reflect.construct(Super, arguments, NewTarget);\n      } else {\n        result = Super.apply(this, arguments);\n      }\n\n      return _possibleConstructorReturn(this, result);\n    };\n  }\n\n  function _defineProperty$1(obj, key, value) {\n    if (key in obj) {\n      Object.defineProperty(obj, key, {\n        value: value,\n        enumerable: true,\n        configurable: true,\n        writable: true\n      });\n    } else {\n      obj[key] = value;\n    }\n\n    return obj;\n  }\n\n  function ownKeys$1(object, enumerableOnly) {\n    var keys = Object.keys(object);\n\n    if (Object.getOwnPropertySymbols) {\n      var symbols = Object.getOwnPropertySymbols(object);\n      if (enumerableOnly) symbols = symbols.filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n      });\n      keys.push.apply(keys, symbols);\n    }\n\n    return keys;\n  }\n\n  function _objectSpread2$1(target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i] != null ? arguments[i] : {};\n\n      if (i % 2) {\n        ownKeys$1(Object(source), true).forEach(function (key) {\n          _defineProperty$1(target, key, source[key]);\n        });\n      } else if (Object.getOwnPropertyDescriptors) {\n        Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n      } else {\n        ownKeys$1(Object(source)).forEach(function (key) {\n          Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n        });\n      }\n    }\n\n    return target;\n  }\n  /* eslint-disable no-empty */\n\n  /* eslint-disable no-undef */\n\n\n  const {\n    toString\n  } = Object.prototype;\n\n  function isPlainObject(target) {\n    return toString.call(target) === '[object Object]';\n  }\n\n  function isString(target) {\n    return toString.call(target) === '[object String]';\n  }\n\n  function isArray(target) {\n    return toString.call(target) === '[object Array]';\n  }\n\n  function isEmptyObject(target) {\n    if (!isPlainObject(target)) return false;\n    return Object.keys(target).length > 0;\n  }\n\n  function isBoolean(target) {\n    return toString.call(target) === '[object Boolean]';\n  }\n\n  function isFunction(target) {\n    return typeof target === 'function';\n  }\n\n  function isNumber(target) {\n    // eslint-disable-next-line no-restricted-globals\n    return toString.call(target) === '[object Number]' && !isNaN(target);\n  }\n\n  function isPromise(object) {\n    if (Promise && Promise.resolve) {\n      return Promise.resolve(object) == object;\n    }\n  }\n\n  function extend(target, source) {\n    return _objectSpread2$1(_objectSpread2$1({}, target), source);\n  }\n\n  function getAgent() {\n    try {\n      if (window && window.history) {\n        return 'WEB_APP';\n      }\n\n      if (wx) {\n        return 'WX_MINI_APP';\n      }\n\n      if (swan) {\n        return 'BAIDU_MINI_APP';\n      }\n\n      if (my) {\n        return 'ALIPAY_MINI_APP';\n      }\n\n      if (tt) {\n        return 'TT_MINI_APP';\n      }\n\n      if (qq) {\n        return 'QQ_MINI_APP';\n      }\n\n      if (quick) {\n        return 'QUICK_APP';\n      }\n    } catch (err) {\n      return 'UNKNOWN_APP';\n    }\n  }\n\n  function getGlobal() {\n    try {\n      if (window && window.history) {\n        return window;\n      }\n\n      if (wx) {\n        return wx;\n      }\n\n      if (swan) {\n        return swan;\n      }\n\n      if (my) {\n        return my;\n      }\n\n      if (tt) {\n        return tt;\n      }\n\n      if (qq) {\n        return qq;\n      }\n    } catch (err) {\n      return {};\n    }\n  }\n\n  function getSystemInfo() {\n    // 这里做个缓存\n    const globalObj = getGlobal();\n    const key = '__sniper__internal__data__';\n\n    if (globalObj[key] && !isEmptyObject(globalObj[key].systemInfo || {})) {\n      return globalObj[key].systemInfo;\n    }\n\n    try {\n      const systemInfo = globalObj.getSystemInfoSync();\n      globalObj[key] = globalObj[key] || {};\n      globalObj[key].systemInfo = systemInfo;\n      return systemInfo;\n    } catch (err) {\n      return {};\n    }\n  }\n\n  function getMeta() {\n    return {\n      agent: getAgent(),\n      system: Object.assign({}, getSystemInfo())\n    };\n  }\n\n  function _defineProperty$2(obj, key, value) {\n    if (key in obj) {\n      Object.defineProperty(obj, key, {\n        value: value,\n        enumerable: true,\n        configurable: true,\n        writable: true\n      });\n    } else {\n      obj[key] = value;\n    }\n\n    return obj;\n  }\n\n  function ownKeys$2(object, enumerableOnly) {\n    var keys = Object.keys(object);\n\n    if (Object.getOwnPropertySymbols) {\n      var symbols = Object.getOwnPropertySymbols(object);\n      if (enumerableOnly) symbols = symbols.filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n      });\n      keys.push.apply(keys, symbols);\n    }\n\n    return keys;\n  }\n\n  function _objectSpread2$2(target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i] != null ? arguments[i] : {};\n\n      if (i % 2) {\n        ownKeys$2(Object(source), true).forEach(function (key) {\n          _defineProperty$2(target, key, source[key]);\n        });\n      } else if (Object.getOwnPropertyDescriptors) {\n        Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n      } else {\n        ownKeys$2(Object(source)).forEach(function (key) {\n          Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n        });\n      }\n    }\n\n    return target;\n  }\n\n  function throwErr(err) {\n    throw new Error(err);\n  }\n\n  const strategies = {\n    url: {\n      validate(val) {\n        if (!val) {\n          throwErr(this.msgRequred);\n        }\n      },\n\n      msgRequred: 'SNIPER ERROR: 配置中 url 字段必填.'\n    },\n    appVersion: {\n      validate(val) {\n        if (!val) return;\n\n        if (!isString(val)) {\n          throwErr(this.msgTypeErr);\n        }\n      },\n\n      msgTypeErr: 'SNIPER ERROR: 配置中 appVersion 字段类型需为 String.'\n    },\n    env: {\n      validate(val) {\n        if (!val) return;\n\n        if (!isString(val)) {\n          throwErr(this.msgTypeErr);\n        }\n      },\n\n      msgTypeErr: 'SNIPER ERROR: 配置中 env 字段类型需为 String.'\n    },\n    repeat: {\n      validate(val) {\n        if (!isNumber(val)) {\n          throwErr(this.msgTypeErr);\n        }\n      },\n\n      msgTypeErr: 'SNIPER ERROR: 配置中 repeat 字段类型需为 Number.'\n    },\n    ignoreErrors: {\n      validate(val) {\n        if (!isArray(val)) {\n          throwErr(this.msgTypeErr);\n        }\n      },\n\n      msgTypeErr: 'SNIPER ERROR: 配置中 ignoreErrors 字段类型需为 Array.'\n    },\n    autoBreadcrumbs: {\n      validate(val) {\n        if (!isBoolean(val)) {\n          throwErr(this.msgTypeErr);\n        }\n      },\n\n      msgTypeErr: 'SNIPER ERROR: 配置中 autoBreadcrumbs 字段类型需为 Array.'\n    },\n    breadcrumbsMax: {\n      validate(val) {\n        if (!isNumber(val)) {\n          throwErr(this.msgTypeErr);\n        }\n      },\n\n      msgTypeErr: 'SNIPER ERROR: 配置中 breadcrumbsMax 字段类型需为 Number.'\n    },\n    random: {\n      validate(val) {\n        if (!isNumber(val)) {\n          throwErr(this.msgTypeErr);\n        } else if (!(val > 0 && val <= 1)) {\n          throwErr(this.msgRangeErr);\n        }\n      },\n\n      msgTypeErr: 'SNIPER ERROR: 配置中 breadcrumbsMax 字段类型需为 Number.',\n      msgRangeErr: 'SNIPER ERROR: 配置中 breadcrumbsMax 字段范围需满足 (0, 1]'\n    },\n    delay: {\n      validate(val) {\n        if (!isNumber(val)) {\n          throwErr(this.msgTypeErr);\n        }\n      },\n\n      msgTypeErr: 'SNIPER ERROR: 配置中 delay 字段类型需为 Number.'\n    },\n    beforeReport: {\n      validate(val) {\n        if (!isFunction(val)) {\n          throwErr(this.msgTypeErr);\n        }\n      },\n\n      msgTypeErr: 'SNIPER ERROR: 配置中 beforeReport 字段类型需为 Function.'\n    }\n  };\n\n  function proxyValidate() {\n    const proxyObj = {};\n    return new Proxy(proxyObj, {\n      set(target, key, val) {\n        strategies[key].validate(val); // eslint-disable-next-line no-param-reassign\n\n        target[key] = val;\n        return true;\n      }\n\n    });\n  }\n\n  function validateConfig(config) {\n    const proxy = proxyValidate();\n    Object.keys(config).forEach(prop => {\n      proxy[prop] = config[prop];\n    });\n  }\n\n  let BehaviorReporter = /*#__PURE__*/function () {\n    function BehaviorReporter() {\n      _classCallCheck(this, BehaviorReporter);\n\n      this.logQueue = [];\n      this.config = {\n        url: '',\n        appkey: '',\n        // 以后商业化要用到的\n        delay: 1000,\n        // 延迟, 合并上报\n        appVersion: '',\n        // 应用Version\n        env: '',\n\n        // 环境\n        beforeReport(log) {\n          // 1.可在这里劫持上报的数据, 比如添加userid, session等等\n          // 2.如果return false, 则不用内置http上报, 此时可以在这里自定义自己的http上报方式\n          //   比如以后浏览器端，可以自定义 ajax 上报还是用图片上报\n          return log;\n        }\n\n      };\n      this.applyRequested = false;\n      this.delayTimer = -1;\n    }\n\n    _createClass(BehaviorReporter, [{\n      key: \"mergeConfig\",\n      value: function mergeConfig(opts) {\n        validateConfig(opts);\n        this.config = extend(this.config, opts);\n      }\n    }, {\n      key: \"addLog\",\n      value: function addLog(log) {\n        this.logQueue.push(log);\n        return this;\n      }\n    }, {\n      key: \"getLog\",\n      value: function getLog() {\n        return this.logQueue.slice();\n      }\n    }, {\n      key: \"clearLog\",\n      value: function clearLog() {\n        this.logQueue = [];\n        return this;\n      }\n    }, {\n      key: \"report\",\n      value: function report() {\n        const curLogQueue = this.getLog();\n\n        if (this.config.delay > 0) {\n          if (this.delayTimer) {\n            clearTimeout(this.delayTimer);\n          }\n\n          this.delayTimer = setTimeout(() => {\n            this.sendLog(curLogQueue);\n          }, this.config.delay);\n        } else {\n          this.sendLog(curLogQueue);\n        }\n      }\n    }, {\n      key: \"gLog\",\n      value: function gLog(log) {\n        const {\n          appVersion,\n          env\n        } = this.config;\n        return _objectSpread2$2(_objectSpread2$2({}, getMeta()), {}, {\n          appVersion,\n          env,\n          logs: log\n        });\n      }\n    }, {\n      key: \"sendLog\",\n      value: function sendLog(logQueue = []) {\n        const log = logQueue.slice();\n        if (!log.length) return;\n        const data = this.gLog(log);\n        const ret = isFunction(this.config.beforeReport) && this.config.beforeReport.call(this, data); // 异步回调\n\n        if (isPromise(ret)) {\n          ret.then(res => {\n            if (isBoolean(res) && res === false) {\n              // 用户阻止默认上报后，可在 beforeReport 可自定义 request 上报\n              return;\n            }\n\n            this.startReport(res);\n          });\n        } else {\n          if (isBoolean(ret) && ret === false) {\n            // 用户阻止默认上报后，可在 beforeReport 可自定义 request 上报\n            return;\n          }\n\n          this.startReport(ret);\n        }\n      }\n    }, {\n      key: \"startReport\",\n      value: function startReport(data) {\n        this.clearLog(); // 默认上报\n\n        this.request({\n          url: this.config.url,\n          method: 'POST',\n          data\n        });\n      }\n    }, {\n      key: \"use\",\n      value: function use(plugin, ...args) {\n        plugin.init(this, ...args);\n      }\n    }, {\n      key: \"applyRequest\",\n      value: function applyRequest(request) {\n        if (this.applyRequested) return false;\n        this.request = request;\n        this.applyRequested = true;\n        return true;\n      }\n    }]);\n\n    return BehaviorReporter;\n  }();\n\n  const parseReportLog = list => {\n    const arr = [+new Date(), 'web', 'h5'];\n    return arr.concat(list).join('*');\n  };\n\n  const getElmPath = e => {\n    const maxDeep = 5;\n    if (!e || 1 !== e.nodeType) return '';\n    var ret = [],\n        deepLength = 0,\n        elm = '';\n    ret.push(`(${e.innerText.substr(0, 50)})`);\n\n    for (var t = e || null; t && deepLength++ < maxDeep && !('html' === (elm = normalTarget(t)));) {\n      ret.push(elm), t = t.parentNode;\n    }\n\n    return ret.reverse().join(' > ');\n  };\n\n  const getCommonAttribute = () => {\n    return {\n      url: encodeURIComponent(window.location.href),\n      time: +new Date()\n    };\n  };\n\n  const normalTarget = function (e) {\n    var t,\n        n,\n        r,\n        a,\n        i,\n        o = [];\n    if (!e || !e.tagName) return '';\n\n    if (o.push(e.tagName.toLowerCase()), e.id && o.push('#'.concat(e.id)), (t = e.className) && '[object String]' === Object.prototype.toString.call(t)) {\n      for (n = t.split(/\\s+/), i = 0; i < n.length; i++) {\n        // className包含active的不加入路径\n        if (n[i].indexOf('active') < 0) o.push('.'.concat(n[i]));\n      }\n    }\n\n    var s = ['type', 'name', 'title', 'alt', 'src'];\n\n    for (i = 0; i < s.length; i++) r = s[i], (a = e.getAttribute(r)) && o.push('['.concat(r, '=\"').concat(a, '\"]'));\n\n    return o.join('');\n  };\n\n  function theEventError (error) {\n    // ErrorEvent 捕获异常, Event 资源错误\n    const commonAttr = getCommonAttribute();\n    let msg = '',\n        errcode = '';\n\n    if (error instanceof ErrorEvent) {\n      msg = error.message;\n      errcode = 'error';\n    } else {\n      const thePath = getElmPath(error.target);\n      msg = '资源错误: ' + thePath;\n      errcode = 'resource_error';\n    }\n\n    const data = _objectSpread2(_objectSpread2({}, commonAttr), {\n      errcode,\n      errmsg: msg\n    });\n\n    const errLog = parseReportLog([`web_error:${JSON.stringify(data)}`]);\n    this.addLog(errLog);\n    this.report();\n  }\n\n  function theEventUnhandledrejection (e) {\n    e.preventDefault();\n    const commonAttr = getCommonAttribute();\n\n    const data = _objectSpread2(_objectSpread2({}, commonAttr), {\n      errcode: 'unhandledrejection',\n      errmsg: e.reason.stack\n    });\n\n    const errLog = parseReportLog([`web_error:${JSON.stringify(data)}`]);\n    this.addLog(errLog);\n    this.report();\n  }\n\n  function theEventClick (event) {\n    var target;\n\n    try {\n      target = event.target;\n    } catch (err) {\n      target = '<unknown>';\n    }\n\n    if (target.nodeName === 'HTML' || target.nodeName === 'TEXTAREA') return;\n    if (target.length === 0) return;\n    const thePath = getElmPath(target);\n    if (!thePath) return;\n    let contentText;\n\n    switch (target.nodeName) {\n      case 'DIV':\n        contentText = target.textContent;\n        break;\n\n      case 'IMG':\n        contentText = target.src;\n        break;\n\n      case 'INPUT':\n        contentText = target.defaultValue;\n        break;\n\n      default:\n        contentText = null;\n    }\n\n    const url = encodeURIComponent(window.location.href);\n    const clickLog = parseReportLog(['click', target.id || target.className, `${url}：${thePath}`, contentText]);\n    this.addLog(clickLog);\n    this.report();\n  }\n\n  function theEventHashchange (event) {\n    const {\n      newURL,\n      oldURL\n    } = event;\n    const hashchangeLog = parseReportLog(['web_to', encodeURIComponent(newURL), encodeURIComponent(oldURL)]);\n    this.addLog(hashchangeLog);\n    this.report();\n  }\n\n  function theEventUnload () {\n    const url = encodeURIComponent(window.location.href);\n    const pageFromLog = parseReportLog(['web_to', url, 'unknown']);\n    this.addLog(pageFromLog);\n    this.report();\n  }\n\n  function theEventHistorystatechanged (event) {\n    const {\n      target\n    } = event;\n    const hashchangeLog = parseReportLog(['web_to', 'unknow', encodeURIComponent(target.location.href)]);\n    this.addLog(hashchangeLog);\n    this.report();\n  }\n\n  var addEventListener = {\n    init(core) {\n      // 页面加载前\n      const startLog = parseReportLog([`web_start: ${JSON.stringify(getCommonAttribute())}`]);\n      core.addLog(startLog);\n      console.log('core--', core.logQueue);\n      core.report();\n      const initEvent = {\n        //load: { fn: theEventLoad },\n        error: {\n          fn: theEventError\n        },\n        unhandledrejection: {\n          fn: theEventUnhandledrejection\n        },\n        click: {\n          fn: theEventClick\n        },\n        hashchange: {\n          fn: theEventHashchange\n        },\n        unload: {\n          fn: theEventUnload\n        },\n        historystatechanged: {\n          fn: theEventHistorystatechanged\n        }\n      }; // 监听函数不要使用匿名函数, 可以减低内存、自动回收\n\n      Object.keys(initEvent).forEach(key => {\n        const event = initEvent[key];\n        window.addEventListener(key, event.fn.bind(core), true);\n      });\n    }\n\n  };\n\n  function Request(config) {\n    const {\n      url,\n      method,\n      data\n    } = config;\n    let xhr = new XMLHttpRequest();\n    xhr.open(method, url, true);\n    xhr.setRequestHeader('content-type', 'application/x-www-form-urlencoded');\n    xhr.send('ue=' + JSON.stringify(data));\n    return xhr;\n  }\n\n  let Reportor = /*#__PURE__*/function (_BehaviorReporter) {\n    _inherits(Reportor, _BehaviorReporter);\n\n    var _super = _createSuper(Reportor);\n\n    function Reportor(opts = {}) {\n      var _this;\n\n      _classCallCheck(this, Reportor);\n\n      _this = _super.call(this, opts); // 合并参数\n\n      _this.mergeConfig(opts);\n\n      _this.init();\n\n      return _this;\n    }\n\n    _createClass(Reportor, [{\n      key: \"init\",\n      value: function init() {\n        // 劫持 App onError\n        this.use(addEventListener); // this.use(pluginHookWeb);\n        // // 劫持 Request\n        // this.use(pluginHookRq);\n        // this.use(pluginPatchPromise);\n\n        this.applyRequest(Request);\n      }\n    }]);\n\n    return Reportor;\n  }(BehaviorReporter);\n\n  return Reportor;\n\n})));\n"]}]}