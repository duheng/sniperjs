{"remainingRequest":"/Users/Aaron/Desktop/work/qunar/work/ykit3/packages/ykit3-cli/node_modules/babel-loader/lib/index.js??ref--4-2!/Users/Aaron/Desktop/work/qunar/work/sniperjs/packages/WebErrorReporter/dist/index.js","dependencies":[{"path":"/Users/Aaron/Desktop/work/qunar/work/sniperjs/packages/WebErrorReporter/dist/index.js","hash":"674971ca4513893ed00ca80bd4740151"},{"path":"/Users/Aaron/Desktop/work/qunar/work/ykit3/packages/ykit3-cli/node_modules/thread-loader/dist/cjs.js","hash":"bb5f7e540106ebb106f274139566f1d0"},{"path":"/Users/Aaron/Desktop/work/qunar/work/ykit3/packages/ykit3-cli/node_modules/cache-loader-hash/dist/cjs.js","hash":"d62e2d390167bf8193569f1644327c55"},{"path":"/Users/Aaron/Desktop/work/qunar/work/ykit3/packages/ykit3-cli/node_modules/babel-loader/lib/index.js","hash":"19adf3159c902f1ed7907f3931384270"}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKZnVuY3Rpb24gX3NsaWNlZFRvQXJyYXkoYXJyLCBpKSB7IHJldHVybiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB8fCBfdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkoYXJyLCBpKSB8fCBfbm9uSXRlcmFibGVSZXN0KCk7IH0KCmZ1bmN0aW9uIF9ub25JdGVyYWJsZVJlc3QoKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkludmFsaWQgYXR0ZW1wdCB0byBkZXN0cnVjdHVyZSBub24taXRlcmFibGUgaW5zdGFuY2UuXG5JbiBvcmRlciB0byBiZSBpdGVyYWJsZSwgbm9uLWFycmF5IG9iamVjdHMgbXVzdCBoYXZlIGEgW1N5bWJvbC5pdGVyYXRvcl0oKSBtZXRob2QuIik7IH0KCmZ1bmN0aW9uIF91bnN1cHBvcnRlZEl0ZXJhYmxlVG9BcnJheShvLCBtaW5MZW4pIHsgaWYgKCFvKSByZXR1cm47IGlmICh0eXBlb2YgbyA9PT0gInN0cmluZyIpIHJldHVybiBfYXJyYXlMaWtlVG9BcnJheShvLCBtaW5MZW4pOyB2YXIgbiA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChvKS5zbGljZSg4LCAtMSk7IGlmIChuID09PSAiT2JqZWN0IiAmJiBvLmNvbnN0cnVjdG9yKSBuID0gby5jb25zdHJ1Y3Rvci5uYW1lOyBpZiAobiA9PT0gIk1hcCIgfHwgbiA9PT0gIlNldCIpIHJldHVybiBBcnJheS5mcm9tKG8pOyBpZiAobiA9PT0gIkFyZ3VtZW50cyIgfHwgL14oPzpVaXxJKW50KD86OHwxNnwzMikoPzpDbGFtcGVkKT9BcnJheSQvLnRlc3QobikpIHJldHVybiBfYXJyYXlMaWtlVG9BcnJheShvLCBtaW5MZW4pOyB9CgpmdW5jdGlvbiBfYXJyYXlMaWtlVG9BcnJheShhcnIsIGxlbikgeyBpZiAobGVuID09IG51bGwgfHwgbGVuID4gYXJyLmxlbmd0aCkgbGVuID0gYXJyLmxlbmd0aDsgZm9yICh2YXIgaSA9IDAsIGFycjIgPSBuZXcgQXJyYXkobGVuKTsgaSA8IGxlbjsgaSsrKSB7IGFycjJbaV0gPSBhcnJbaV07IH0gcmV0dXJuIGFycjI7IH0KCmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHsgdmFyIF9pID0gYXJyID09IG51bGwgPyBudWxsIDogdHlwZW9mIFN5bWJvbCAhPT0gInVuZGVmaW5lZCIgJiYgYXJyW1N5bWJvbC5pdGVyYXRvcl0gfHwgYXJyWyJAQGl0ZXJhdG9yIl07IGlmIChfaSA9PSBudWxsKSByZXR1cm47IHZhciBfYXJyID0gW107IHZhciBfbiA9IHRydWU7IHZhciBfZCA9IGZhbHNlOyB2YXIgX3MsIF9lOyB0cnkgeyBmb3IgKF9pID0gX2kuY2FsbChhcnIpOyAhKF9uID0gKF9zID0gX2kubmV4dCgpKS5kb25lKTsgX24gPSB0cnVlKSB7IF9hcnIucHVzaChfcy52YWx1ZSk7IGlmIChpICYmIF9hcnIubGVuZ3RoID09PSBpKSBicmVhazsgfSB9IGNhdGNoIChlcnIpIHsgX2QgPSB0cnVlOyBfZSA9IGVycjsgfSBmaW5hbGx5IHsgdHJ5IHsgaWYgKCFfbiAmJiBfaVsicmV0dXJuIl0gIT0gbnVsbCkgX2lbInJldHVybiJdKCk7IH0gZmluYWxseSB7IGlmIChfZCkgdGhyb3cgX2U7IH0gfSByZXR1cm4gX2FycjsgfQoKZnVuY3Rpb24gX2FycmF5V2l0aEhvbGVzKGFycikgeyBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSByZXR1cm4gYXJyOyB9CgpmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyAiQGJhYmVsL2hlbHBlcnMgLSB0eXBlb2YiOyBpZiAodHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09PSAic3ltYm9sIikgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIHR5cGVvZiBvYmo7IH07IH0gZWxzZSB7IF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gInN5bWJvbCIgOiB0eXBlb2Ygb2JqOyB9OyB9IHJldHVybiBfdHlwZW9mKG9iaik7IH0KCihmdW5jdGlvbiAoZ2xvYmFsLCBmYWN0b3J5KSB7CiAgKHR5cGVvZiBleHBvcnRzID09PSAidW5kZWZpbmVkIiA/ICJ1bmRlZmluZWQiIDogX3R5cGVvZihleHBvcnRzKSkgPT09ICdvYmplY3QnICYmIHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnID8gbW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KCkgOiB0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQgPyBkZWZpbmUoZmFjdG9yeSkgOiAoZ2xvYmFsID0gZ2xvYmFsIHx8IHNlbGYsIGdsb2JhbC5TbmlwZXJqcyA9IGZhY3RvcnkoKSk7Cn0pKHZvaWQgMCwgZnVuY3Rpb24gKCkgewogICd1c2Ugc3RyaWN0JzsKCiAgZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgewogICAgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsKICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7CiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7CiAgICAgIHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07CiAgICAgIGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsKICAgICAgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOwogICAgICBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOwogICAgfQogIH0KCiAgZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgewogICAgaWYgKHByb3RvUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7CiAgICBpZiAoc3RhdGljUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7CiAgICByZXR1cm4gQ29uc3RydWN0b3I7CiAgfQoKICBmdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsKICAgIGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gImZ1bmN0aW9uIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7CiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uIik7CiAgICB9CgogICAgc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7CiAgICAgIGNvbnN0cnVjdG9yOiB7CiAgICAgICAgdmFsdWU6IHN1YkNsYXNzLAogICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZQogICAgICB9CiAgICB9KTsKICAgIGlmIChzdXBlckNsYXNzKSBfc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpOwogIH0KCiAgZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsKICAgIF9nZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5nZXRQcm90b3R5cGVPZiA6IGZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7CiAgICAgIHJldHVybiBvLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2Yobyk7CiAgICB9OwogICAgcmV0dXJuIF9nZXRQcm90b3R5cGVPZihvKTsKICB9CgogIGZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7CiAgICBfc2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwgZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsKICAgICAgby5fX3Byb3RvX18gPSBwOwogICAgICByZXR1cm4gbzsKICAgIH07CgogICAgcmV0dXJuIF9zZXRQcm90b3R5cGVPZihvLCBwKTsKICB9CgogIGZ1bmN0aW9uIF9pc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QoKSB7CiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09ICJ1bmRlZmluZWQiIHx8ICFSZWZsZWN0LmNvbnN0cnVjdCkgcmV0dXJuIGZhbHNlOwogICAgaWYgKFJlZmxlY3QuY29uc3RydWN0LnNoYW0pIHJldHVybiBmYWxzZTsKICAgIGlmICh0eXBlb2YgUHJveHkgPT09ICJmdW5jdGlvbiIpIHJldHVybiB0cnVlOwoKICAgIHRyeSB7CiAgICAgIERhdGUucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoUmVmbGVjdC5jb25zdHJ1Y3QoRGF0ZSwgW10sIGZ1bmN0aW9uICgpIHt9KSk7CiAgICAgIHJldHVybiB0cnVlOwogICAgfSBjYXRjaCAoZSkgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpIHsKICAgIGlmIChzZWxmID09PSB2b2lkIDApIHsKICAgICAgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWQiKTsKICAgIH0KCiAgICByZXR1cm4gc2VsZjsKICB9CgogIGZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsKICAgIGlmIChjYWxsICYmIChfdHlwZW9mKGNhbGwpID09PSAib2JqZWN0IiB8fCB0eXBlb2YgY2FsbCA9PT0gImZ1bmN0aW9uIikpIHsKICAgICAgcmV0dXJuIGNhbGw7CiAgICB9CgogICAgcmV0dXJuIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZik7CiAgfQoKICBmdW5jdGlvbiBfY3JlYXRlU3VwZXIoRGVyaXZlZCkgewogICAgdmFyIGhhc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QgPSBfaXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0KCk7CgogICAgcmV0dXJuIGZ1bmN0aW9uIF9jcmVhdGVTdXBlckludGVybmFsKCkgewogICAgICB2YXIgU3VwZXIgPSBfZ2V0UHJvdG90eXBlT2YoRGVyaXZlZCksCiAgICAgICAgICByZXN1bHQ7CgogICAgICBpZiAoaGFzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCkgewogICAgICAgIHZhciBOZXdUYXJnZXQgPSBfZ2V0UHJvdG90eXBlT2YodGhpcykuY29uc3RydWN0b3I7CgogICAgICAgIHJlc3VsdCA9IFJlZmxlY3QuY29uc3RydWN0KFN1cGVyLCBhcmd1bWVudHMsIE5ld1RhcmdldCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmVzdWx0ID0gU3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIHJlc3VsdCk7CiAgICB9OwogIH0KCiAgZnVuY3Rpb24gX2RlZmluZVByb3BlcnR5KG9iaiwga2V5LCB2YWx1ZSkgewogICAgaWYgKGtleSBpbiBvYmopIHsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7CiAgICAgICAgdmFsdWU6IHZhbHVlLAogICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgIHdyaXRhYmxlOiB0cnVlCiAgICAgIH0pOwogICAgfSBlbHNlIHsKICAgICAgb2JqW2tleV0gPSB2YWx1ZTsKICAgIH0KCiAgICByZXR1cm4gb2JqOwogIH0KCiAgZnVuY3Rpb24gb3duS2V5cyhvYmplY3QsIGVudW1lcmFibGVPbmx5KSB7CiAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG9iamVjdCk7CgogICAgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHsKICAgICAgdmFyIHN5bWJvbHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKG9iamVjdCk7CiAgICAgIGlmIChlbnVtZXJhYmxlT25seSkgc3ltYm9scyA9IHN5bWJvbHMuZmlsdGVyKGZ1bmN0aW9uIChzeW0pIHsKICAgICAgICByZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHN5bSkuZW51bWVyYWJsZTsKICAgICAgfSk7CiAgICAgIGtleXMucHVzaC5hcHBseShrZXlzLCBzeW1ib2xzKTsKICAgIH0KCiAgICByZXR1cm4ga2V5czsKICB9CgogIGZ1bmN0aW9uIF9vYmplY3RTcHJlYWQyKHRhcmdldCkgewogICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsKICAgICAgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpXSAhPSBudWxsID8gYXJndW1lbnRzW2ldIDoge307CgogICAgICBpZiAoaSAlIDIpIHsKICAgICAgICBvd25LZXlzKE9iamVjdChzb3VyY2UpLCB0cnVlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICAgIF9kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgc291cmNlW2tleV0pOwogICAgICAgIH0pOwogICAgICB9IGVsc2UgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKSB7CiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhzb3VyY2UpKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBvd25LZXlzKE9iamVjdChzb3VyY2UpKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihzb3VyY2UsIGtleSkpOwogICAgICAgIH0pOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHRhcmdldDsKICB9CiAgLyogZXNsaW50LWRpc2FibGUgbm8tZW1wdHkgKi8KCiAgLyogZXNsaW50LWRpc2FibGUgbm8tdW5kZWYgKi8KCgogIHZhciB0b1N0cmluZyA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmc7CgogIGZ1bmN0aW9uIGlzUGxhaW5PYmplY3QodGFyZ2V0KSB7CiAgICByZXR1cm4gdG9TdHJpbmcuY2FsbCh0YXJnZXQpID09PSAnW29iamVjdCBPYmplY3RdJzsKICB9CgogIGZ1bmN0aW9uIGlzU3RyaW5nKHRhcmdldCkgewogICAgcmV0dXJuIHRvU3RyaW5nLmNhbGwodGFyZ2V0KSA9PT0gJ1tvYmplY3QgU3RyaW5nXSc7CiAgfQoKICBmdW5jdGlvbiBpc0FycmF5KHRhcmdldCkgewogICAgcmV0dXJuIHRvU3RyaW5nLmNhbGwodGFyZ2V0KSA9PT0gJ1tvYmplY3QgQXJyYXldJzsKICB9CgogIGZ1bmN0aW9uIGlzRW1wdHlPYmplY3QodGFyZ2V0KSB7CiAgICBpZiAoIWlzUGxhaW5PYmplY3QodGFyZ2V0KSkgcmV0dXJuIGZhbHNlOwogICAgcmV0dXJuIE9iamVjdC5rZXlzKHRhcmdldCkubGVuZ3RoID4gMDsKICB9CgogIGZ1bmN0aW9uIGlzQm9vbGVhbih0YXJnZXQpIHsKICAgIHJldHVybiB0b1N0cmluZy5jYWxsKHRhcmdldCkgPT09ICdbb2JqZWN0IEJvb2xlYW5dJzsKICB9CgogIGZ1bmN0aW9uIGlzRnVuY3Rpb24odGFyZ2V0KSB7CiAgICByZXR1cm4gdHlwZW9mIHRhcmdldCA9PT0gJ2Z1bmN0aW9uJzsKICB9CgogIGZ1bmN0aW9uIGlzTnVtYmVyKHRhcmdldCkgewogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXJlc3RyaWN0ZWQtZ2xvYmFscwogICAgcmV0dXJuIHRvU3RyaW5nLmNhbGwodGFyZ2V0KSA9PT0gJ1tvYmplY3QgTnVtYmVyXScgJiYgIWlzTmFOKHRhcmdldCk7CiAgfQoKICBmdW5jdGlvbiBpc1Byb21pc2Uob2JqZWN0KSB7CiAgICBpZiAoUHJvbWlzZSAmJiBQcm9taXNlLnJlc29sdmUpIHsKICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShvYmplY3QpID09IG9iamVjdDsKICAgIH0KICB9CgogIGZ1bmN0aW9uIGV4dGVuZCh0YXJnZXQsIHNvdXJjZSkgewogICAgcmV0dXJuIF9vYmplY3RTcHJlYWQyKF9vYmplY3RTcHJlYWQyKHt9LCB0YXJnZXQpLCBzb3VyY2UpOwogIH0KCiAgZnVuY3Rpb24gZ2V0QWdlbnQoKSB7CiAgICB0cnkgewogICAgICBpZiAod2luZG93ICYmIHdpbmRvdy5oaXN0b3J5KSB7CiAgICAgICAgcmV0dXJuICdXRUJfQVBQJzsKICAgICAgfQoKICAgICAgaWYgKHd4KSB7CiAgICAgICAgcmV0dXJuICdXWF9NSU5JX0FQUCc7CiAgICAgIH0KCiAgICAgIGlmIChzd2FuKSB7CiAgICAgICAgcmV0dXJuICdCQUlEVV9NSU5JX0FQUCc7CiAgICAgIH0KCiAgICAgIGlmIChteSkgewogICAgICAgIHJldHVybiAnQUxJUEFZX01JTklfQVBQJzsKICAgICAgfQoKICAgICAgaWYgKHR0KSB7CiAgICAgICAgcmV0dXJuICdUVF9NSU5JX0FQUCc7CiAgICAgIH0KCiAgICAgIGlmIChxcSkgewogICAgICAgIHJldHVybiAnUVFfTUlOSV9BUFAnOwogICAgICB9CgogICAgICBpZiAocXVpY2spIHsKICAgICAgICByZXR1cm4gJ1FVSUNLX0FQUCc7CiAgICAgIH0KICAgIH0gY2F0Y2ggKGVycikgewogICAgICByZXR1cm4gJ1VOS05PV05fQVBQJzsKICAgIH0KICB9CgogIGZ1bmN0aW9uIGdldEdsb2JhbCgpIHsKICAgIHRyeSB7CiAgICAgIGlmICh3aW5kb3cgJiYgd2luZG93Lmhpc3RvcnkpIHsKICAgICAgICByZXR1cm4gd2luZG93OwogICAgICB9CgogICAgICBpZiAod3gpIHsKICAgICAgICByZXR1cm4gd3g7CiAgICAgIH0KCiAgICAgIGlmIChzd2FuKSB7CiAgICAgICAgcmV0dXJuIHN3YW47CiAgICAgIH0KCiAgICAgIGlmIChteSkgewogICAgICAgIHJldHVybiBteTsKICAgICAgfQoKICAgICAgaWYgKHR0KSB7CiAgICAgICAgcmV0dXJuIHR0OwogICAgICB9CgogICAgICBpZiAocXEpIHsKICAgICAgICByZXR1cm4gcXE7CiAgICAgIH0KICAgIH0gY2F0Y2ggKGVycikgewogICAgICByZXR1cm4ge307CiAgICB9CiAgfQoKICBmdW5jdGlvbiBnZXRTeXN0ZW1JbmZvKCkgewogICAgLy8g6L+Z6YeM5YGa5Liq57yT5a2YCiAgICB2YXIgZ2xvYmFsT2JqID0gZ2V0R2xvYmFsKCk7CiAgICB2YXIga2V5ID0gJ19fc25pcGVyX19pbnRlcm5hbF9fZGF0YV9fJzsKCiAgICBpZiAoZ2xvYmFsT2JqW2tleV0gJiYgIWlzRW1wdHlPYmplY3QoZ2xvYmFsT2JqW2tleV0uc3lzdGVtSW5mbyB8fCB7fSkpIHsKICAgICAgcmV0dXJuIGdsb2JhbE9ialtrZXldLnN5c3RlbUluZm87CiAgICB9CgogICAgdHJ5IHsKICAgICAgdmFyIHN5c3RlbUluZm8gPSBnbG9iYWxPYmouZ2V0U3lzdGVtSW5mb1N5bmMoKTsKICAgICAgZ2xvYmFsT2JqW2tleV0gPSBnbG9iYWxPYmpba2V5XSB8fCB7fTsKICAgICAgZ2xvYmFsT2JqW2tleV0uc3lzdGVtSW5mbyA9IHN5c3RlbUluZm87CiAgICAgIHJldHVybiBzeXN0ZW1JbmZvOwogICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgIHJldHVybiB7fTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIGdldE1ldGEoKSB7CiAgICByZXR1cm4gewogICAgICBhZ2VudDogZ2V0QWdlbnQoKSwKICAgICAgc3lzdGVtOiBPYmplY3QuYXNzaWduKHt9LCBnZXRTeXN0ZW1JbmZvKCkpCiAgICB9OwogIH0KCiAgZnVuY3Rpb24gX2RlZmluZVByb3BlcnR5JDEob2JqLCBrZXksIHZhbHVlKSB7CiAgICBpZiAoa2V5IGluIG9iaikgewogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHsKICAgICAgICB2YWx1ZTogdmFsdWUsCiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgd3JpdGFibGU6IHRydWUKICAgICAgfSk7CiAgICB9IGVsc2UgewogICAgICBvYmpba2V5XSA9IHZhbHVlOwogICAgfQoKICAgIHJldHVybiBvYmo7CiAgfQoKICBmdW5jdGlvbiBvd25LZXlzJDEob2JqZWN0LCBlbnVtZXJhYmxlT25seSkgewogICAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhvYmplY3QpOwoKICAgIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7CiAgICAgIHZhciBzeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhvYmplY3QpOwogICAgICBpZiAoZW51bWVyYWJsZU9ubHkpIHN5bWJvbHMgPSBzeW1ib2xzLmZpbHRlcihmdW5jdGlvbiAoc3ltKSB7CiAgICAgICAgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBzeW0pLmVudW1lcmFibGU7CiAgICAgIH0pOwogICAgICBrZXlzLnB1c2guYXBwbHkoa2V5cywgc3ltYm9scyk7CiAgICB9CgogICAgcmV0dXJuIGtleXM7CiAgfQoKICBmdW5jdGlvbiBfb2JqZWN0U3ByZWFkMiQxKHRhcmdldCkgewogICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsKICAgICAgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpXSAhPSBudWxsID8gYXJndW1lbnRzW2ldIDoge307CgogICAgICBpZiAoaSAlIDIpIHsKICAgICAgICBvd25LZXlzJDEoT2JqZWN0KHNvdXJjZSksIHRydWUpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgICAgX2RlZmluZVByb3BlcnR5JDEodGFyZ2V0LCBrZXksIHNvdXJjZVtrZXldKTsKICAgICAgICB9KTsKICAgICAgfSBlbHNlIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycykgewogICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMoc291cmNlKSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgb3duS2V5cyQxKE9iamVjdChzb3VyY2UpKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihzb3VyY2UsIGtleSkpOwogICAgICAgIH0pOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHRhcmdldDsKICB9CgogIGZ1bmN0aW9uIHRocm93RXJyKGVycikgewogICAgdGhyb3cgbmV3IEVycm9yKGVycik7CiAgfQoKICB2YXIgc3RyYXRlZ2llcyA9IHsKICAgIHVybDogewogICAgICB2YWxpZGF0ZTogZnVuY3Rpb24gdmFsaWRhdGUodmFsKSB7CiAgICAgICAgaWYgKCF2YWwpIHsKICAgICAgICAgIHRocm93RXJyKHRoaXMubXNnUmVxdXJlZCk7CiAgICAgICAgfQogICAgICB9LAogICAgICBtc2dSZXF1cmVkOiAnU05JUEVSIEVSUk9SOiDphY3nva7kuK0gdXJsIOWtl+auteW/heWhqy4nCiAgICB9LAogICAgYXBwVmVyc2lvbjogewogICAgICB2YWxpZGF0ZTogZnVuY3Rpb24gdmFsaWRhdGUodmFsKSB7CiAgICAgICAgaWYgKCF2YWwpIHJldHVybjsKCiAgICAgICAgaWYgKCFpc1N0cmluZyh2YWwpKSB7CiAgICAgICAgICB0aHJvd0Vycih0aGlzLm1zZ1R5cGVFcnIpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgbXNnVHlwZUVycjogJ1NOSVBFUiBFUlJPUjog6YWN572u5LitIGFwcFZlcnNpb24g5a2X5q6157G75Z6L6ZyA5Li6IFN0cmluZy4nCiAgICB9LAogICAgZW52OiB7CiAgICAgIHZhbGlkYXRlOiBmdW5jdGlvbiB2YWxpZGF0ZSh2YWwpIHsKICAgICAgICBpZiAoIXZhbCkgcmV0dXJuOwoKICAgICAgICBpZiAoIWlzU3RyaW5nKHZhbCkpIHsKICAgICAgICAgIHRocm93RXJyKHRoaXMubXNnVHlwZUVycik7CiAgICAgICAgfQogICAgICB9LAogICAgICBtc2dUeXBlRXJyOiAnU05JUEVSIEVSUk9SOiDphY3nva7kuK0gZW52IOWtl+auteexu+Wei+mcgOS4uiBTdHJpbmcuJwogICAgfSwKICAgIHJlcGVhdDogewogICAgICB2YWxpZGF0ZTogZnVuY3Rpb24gdmFsaWRhdGUodmFsKSB7CiAgICAgICAgaWYgKCFpc051bWJlcih2YWwpKSB7CiAgICAgICAgICB0aHJvd0Vycih0aGlzLm1zZ1R5cGVFcnIpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgbXNnVHlwZUVycjogJ1NOSVBFUiBFUlJPUjog6YWN572u5LitIHJlcGVhdCDlrZfmrrXnsbvlnovpnIDkuLogTnVtYmVyLicKICAgIH0sCiAgICBpZ25vcmVFcnJvcnM6IHsKICAgICAgdmFsaWRhdGU6IGZ1bmN0aW9uIHZhbGlkYXRlKHZhbCkgewogICAgICAgIGlmICghaXNBcnJheSh2YWwpKSB7CiAgICAgICAgICB0aHJvd0Vycih0aGlzLm1zZ1R5cGVFcnIpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgbXNnVHlwZUVycjogJ1NOSVBFUiBFUlJPUjog6YWN572u5LitIGlnbm9yZUVycm9ycyDlrZfmrrXnsbvlnovpnIDkuLogQXJyYXkuJwogICAgfSwKICAgIGF1dG9CcmVhZGNydW1iczogewogICAgICB2YWxpZGF0ZTogZnVuY3Rpb24gdmFsaWRhdGUodmFsKSB7CiAgICAgICAgaWYgKCFpc0Jvb2xlYW4odmFsKSkgewogICAgICAgICAgdGhyb3dFcnIodGhpcy5tc2dUeXBlRXJyKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIG1zZ1R5cGVFcnI6ICdTTklQRVIgRVJST1I6IOmFjee9ruS4rSBhdXRvQnJlYWRjcnVtYnMg5a2X5q6157G75Z6L6ZyA5Li6IEFycmF5LicKICAgIH0sCiAgICBicmVhZGNydW1ic01heDogewogICAgICB2YWxpZGF0ZTogZnVuY3Rpb24gdmFsaWRhdGUodmFsKSB7CiAgICAgICAgaWYgKCFpc051bWJlcih2YWwpKSB7CiAgICAgICAgICB0aHJvd0Vycih0aGlzLm1zZ1R5cGVFcnIpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgbXNnVHlwZUVycjogJ1NOSVBFUiBFUlJPUjog6YWN572u5LitIGJyZWFkY3J1bWJzTWF4IOWtl+auteexu+Wei+mcgOS4uiBOdW1iZXIuJwogICAgfSwKICAgIHJhbmRvbTogewogICAgICB2YWxpZGF0ZTogZnVuY3Rpb24gdmFsaWRhdGUodmFsKSB7CiAgICAgICAgaWYgKCFpc051bWJlcih2YWwpKSB7CiAgICAgICAgICB0aHJvd0Vycih0aGlzLm1zZ1R5cGVFcnIpOwogICAgICAgIH0gZWxzZSBpZiAoISh2YWwgPiAwICYmIHZhbCA8PSAxKSkgewogICAgICAgICAgdGhyb3dFcnIodGhpcy5tc2dSYW5nZUVycik7CiAgICAgICAgfQogICAgICB9LAogICAgICBtc2dUeXBlRXJyOiAnU05JUEVSIEVSUk9SOiDphY3nva7kuK0gYnJlYWRjcnVtYnNNYXgg5a2X5q6157G75Z6L6ZyA5Li6IE51bWJlci4nLAogICAgICBtc2dSYW5nZUVycjogJ1NOSVBFUiBFUlJPUjog6YWN572u5LitIGJyZWFkY3J1bWJzTWF4IOWtl+auteiMg+WbtOmcgOa7oei2syAoMCwgMV0nCiAgICB9LAogICAgZGVsYXk6IHsKICAgICAgdmFsaWRhdGU6IGZ1bmN0aW9uIHZhbGlkYXRlKHZhbCkgewogICAgICAgIGlmICghaXNOdW1iZXIodmFsKSkgewogICAgICAgICAgdGhyb3dFcnIodGhpcy5tc2dUeXBlRXJyKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIG1zZ1R5cGVFcnI6ICdTTklQRVIgRVJST1I6IOmFjee9ruS4rSBkZWxheSDlrZfmrrXnsbvlnovpnIDkuLogTnVtYmVyLicKICAgIH0sCiAgICBiZWZvcmVSZXBvcnQ6IHsKICAgICAgdmFsaWRhdGU6IGZ1bmN0aW9uIHZhbGlkYXRlKHZhbCkgewogICAgICAgIGlmICghaXNGdW5jdGlvbih2YWwpKSB7CiAgICAgICAgICB0aHJvd0Vycih0aGlzLm1zZ1R5cGVFcnIpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgbXNnVHlwZUVycjogJ1NOSVBFUiBFUlJPUjog6YWN572u5LitIGJlZm9yZVJlcG9ydCDlrZfmrrXnsbvlnovpnIDkuLogRnVuY3Rpb24uJwogICAgfQogIH07CgogIGZ1bmN0aW9uIHByb3h5VmFsaWRhdGUoKSB7CiAgICB2YXIgcHJveHlPYmogPSB7fTsKICAgIHJldHVybiBuZXcgUHJveHkocHJveHlPYmosIHsKICAgICAgc2V0OiBmdW5jdGlvbiBzZXQodGFyZ2V0LCBrZXksIHZhbCkgewogICAgICAgIHN0cmF0ZWdpZXNba2V5XS52YWxpZGF0ZSh2YWwpOyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcGFyYW0tcmVhc3NpZ24KCiAgICAgICAgdGFyZ2V0W2tleV0gPSB2YWw7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KICAgIH0pOwogIH0KCiAgZnVuY3Rpb24gdmFsaWRhdGVDb25maWcoY29uZmlnKSB7CiAgICB2YXIgcHJveHkgPSBwcm94eVZhbGlkYXRlKCk7CiAgICBPYmplY3Qua2V5cyhjb25maWcpLmZvckVhY2goZnVuY3Rpb24gKHByb3ApIHsKICAgICAgcHJveHlbcHJvcF0gPSBjb25maWdbcHJvcF07CiAgICB9KTsKICB9CgogIHZhciBCZWhhdmlvclJlcG9ydGVyID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICAgIGZ1bmN0aW9uIEJlaGF2aW9yUmVwb3J0ZXIoKSB7CiAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBCZWhhdmlvclJlcG9ydGVyKTsKCiAgICAgIHRoaXMubG9nUXVldWUgPSBbXTsKICAgICAgdGhpcy5jb25maWcgPSB7CiAgICAgICAgdXJsOiAnJywKICAgICAgICBhcHBrZXk6ICcnLAogICAgICAgIC8vIOS7peWQjuWVhuS4muWMluimgeeUqOWIsOeahAogICAgICAgIGRlbGF5OiAxMDAwLAogICAgICAgIC8vIOW7tui/nywg5ZCI5bm25LiK5oqlCiAgICAgICAgYXBwVmVyc2lvbjogJycsCiAgICAgICAgLy8g5bqU55SoVmVyc2lvbgogICAgICAgIGVudjogJycsCiAgICAgICAgLy8g546v5aKDCiAgICAgICAgYmVmb3JlUmVwb3J0OiBmdW5jdGlvbiBiZWZvcmVSZXBvcnQobG9nKSB7CiAgICAgICAgICAvLyAxLuWPr+WcqOi/memHjOWKq+aMgeS4iuaKpeeahOaVsOaNriwg5q+U5aaC5re75YqgdXNlcmlkLCBzZXNzaW9u562J562JCiAgICAgICAgICAvLyAyLuWmguaenHJldHVybiBmYWxzZSwg5YiZ5LiN55So5YaF572uaHR0cOS4iuaKpSwg5q2k5pe25Y+v5Lul5Zyo6L+Z6YeM6Ieq5a6a5LmJ6Ieq5bex55qEaHR0cOS4iuaKpeaWueW8jwogICAgICAgICAgLy8gICDmr5TlpoLku6XlkI7mtY/op4jlmajnq6/vvIzlj6/ku6Xoh6rlrprkuYkgYWpheCDkuIrmiqXov5jmmK/nlKjlm77niYfkuIrmiqUKICAgICAgICAgIHJldHVybiBsb2c7CiAgICAgICAgfQogICAgICB9OwogICAgICB0aGlzLmFwcGx5UmVxdWVzdGVkID0gZmFsc2U7CiAgICAgIHRoaXMuZGVsYXlUaW1lciA9IC0xOwogICAgfQoKICAgIF9jcmVhdGVDbGFzcyhCZWhhdmlvclJlcG9ydGVyLCBbewogICAgICBrZXk6ICJtZXJnZUNvbmZpZyIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBtZXJnZUNvbmZpZyhvcHRzKSB7CiAgICAgICAgdmFsaWRhdGVDb25maWcob3B0cyk7CiAgICAgICAgdGhpcy5jb25maWcgPSBleHRlbmQodGhpcy5jb25maWcsIG9wdHMpOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImFkZExvZyIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBhZGRMb2cobG9nKSB7CiAgICAgICAgdGhpcy5sb2dRdWV1ZS5wdXNoKGxvZyk7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAiZ2V0TG9nIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldExvZygpIHsKICAgICAgICByZXR1cm4gdGhpcy5sb2dRdWV1ZS5zbGljZSgpOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImNsZWFyTG9nIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNsZWFyTG9nKCkgewogICAgICAgIHRoaXMubG9nUXVldWUgPSBbXTsKICAgICAgICByZXR1cm4gdGhpczsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJyZXBvcnQiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gcmVwb3J0KCkgewogICAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgICB2YXIgY3VyTG9nUXVldWUgPSB0aGlzLmdldExvZygpOwoKICAgICAgICBpZiAodGhpcy5jb25maWcuZGVsYXkgPiAwKSB7CiAgICAgICAgICBpZiAodGhpcy5kZWxheVRpbWVyKSB7CiAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLmRlbGF5VGltZXIpOwogICAgICAgICAgfQoKICAgICAgICAgIHRoaXMuZGVsYXlUaW1lciA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICBfdGhpczIuc2VuZExvZyhjdXJMb2dRdWV1ZSk7CiAgICAgICAgICB9LCB0aGlzLmNvbmZpZy5kZWxheSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuc2VuZExvZyhjdXJMb2dRdWV1ZSk7CiAgICAgICAgfQogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImdMb2ciLAogICAgICB2YWx1ZTogZnVuY3Rpb24gZ0xvZyhsb2cpIHsKICAgICAgICB2YXIgX3RoaXMkY29uZmlnID0gdGhpcy5jb25maWcsCiAgICAgICAgICAgIGFwcFZlcnNpb24gPSBfdGhpcyRjb25maWcuYXBwVmVyc2lvbiwKICAgICAgICAgICAgZW52ID0gX3RoaXMkY29uZmlnLmVudjsKICAgICAgICByZXR1cm4gX29iamVjdFNwcmVhZDIkMShfb2JqZWN0U3ByZWFkMiQxKHt9LCBnZXRNZXRhKCkpLCB7fSwgewogICAgICAgICAgYXBwVmVyc2lvbjogYXBwVmVyc2lvbiwKICAgICAgICAgIGVudjogZW52LAogICAgICAgICAgbG9nczogbG9nCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAic2VuZExvZyIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBzZW5kTG9nKCkgewogICAgICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgICAgICB2YXIgbG9nUXVldWUgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IFtdOwogICAgICAgIHZhciBsb2cgPSBsb2dRdWV1ZS5zbGljZSgpOwogICAgICAgIGlmICghbG9nLmxlbmd0aCkgcmV0dXJuOwogICAgICAgIHZhciBkYXRhID0gdGhpcy5nTG9nKGxvZyk7CiAgICAgICAgdmFyIHJldCA9IGlzRnVuY3Rpb24odGhpcy5jb25maWcuYmVmb3JlUmVwb3J0KSAmJiB0aGlzLmNvbmZpZy5iZWZvcmVSZXBvcnQuY2FsbCh0aGlzLCBkYXRhKTsgLy8g5byC5q2l5Zue6LCDCgogICAgICAgIGlmIChpc1Byb21pc2UocmV0KSkgewogICAgICAgICAgcmV0LnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgICBpZiAoaXNCb29sZWFuKHJlcykgJiYgcmVzID09PSBmYWxzZSkgewogICAgICAgICAgICAgIC8vIOeUqOaIt+mYu+atoum7mOiupOS4iuaKpeWQju+8jOWPr+WcqCBiZWZvcmVSZXBvcnQg5Y+v6Ieq5a6a5LmJIHJlcXVlc3Qg5LiK5oqlCiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgICBfdGhpczMuc3RhcnRSZXBvcnQocmVzKTsKICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBpZiAoaXNCb29sZWFuKHJldCkgJiYgcmV0ID09PSBmYWxzZSkgewogICAgICAgICAgICAvLyDnlKjmiLfpmLvmraLpu5jorqTkuIrmiqXlkI7vvIzlj6/lnKggYmVmb3JlUmVwb3J0IOWPr+iHquWumuS5iSByZXF1ZXN0IOS4iuaKpQogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CgogICAgICAgICAgdGhpcy5zdGFydFJlcG9ydChyZXQpOwogICAgICAgIH0KICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJzdGFydFJlcG9ydCIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBzdGFydFJlcG9ydChkYXRhKSB7CiAgICAgICAgdGhpcy5jbGVhckxvZygpOyAvLyDpu5jorqTkuIrmiqUKCiAgICAgICAgdGhpcy5yZXF1ZXN0KHsKICAgICAgICAgIHVybDogdGhpcy5jb25maWcudXJsLAogICAgICAgICAgbWV0aG9kOiAnUE9TVCcsCiAgICAgICAgICBkYXRhOiBkYXRhCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAidXNlIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIHVzZShwbHVnaW4pIHsKICAgICAgICBmb3IgKHZhciBfbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShfbGVuID4gMSA/IF9sZW4gLSAxIDogMCksIF9rZXkgPSAxOyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7CiAgICAgICAgICBhcmdzW19rZXkgLSAxXSA9IGFyZ3VtZW50c1tfa2V5XTsKICAgICAgICB9CgogICAgICAgIHBsdWdpbi5pbml0LmFwcGx5KHBsdWdpbiwgW3RoaXNdLmNvbmNhdChhcmdzKSk7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAiYXBwbHlSZXF1ZXN0IiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIGFwcGx5UmVxdWVzdChyZXF1ZXN0KSB7CiAgICAgICAgaWYgKHRoaXMuYXBwbHlSZXF1ZXN0ZWQpIHJldHVybiBmYWxzZTsKICAgICAgICB0aGlzLnJlcXVlc3QgPSByZXF1ZXN0OwogICAgICAgIHRoaXMuYXBwbHlSZXF1ZXN0ZWQgPSB0cnVlOwogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CiAgICB9XSk7CgogICAgcmV0dXJuIEJlaGF2aW9yUmVwb3J0ZXI7CiAgfSgpOwoKICB2YXIgZXJyb3JUeXBlUmVnID0gbmV3IFJlZ0V4cCgnKCcgKyBbJ0V2YWxFcnJvcjonLCAnSW50ZXJuYWxFcnJvcjonLCAnUmFuZ2VFcnJvcjonLCAnUmVmZXJlbmNlRXJyb3I6JywgJ1N5bnRheEVycm9yOicsICdUeXBlRXJyb3I6JywgJ1VSSUVycm9yOicsICdFcnJvcjonIC8vIG5ldyBFcnJvcgogIF0uam9pbignfCcpICsgJyknLCAnbWknKTsKICAvKiBlc2xpbnQtZGlzYWJsZSBrZXktc3BhY2luZyAqLwoKICBmdW5jdGlvbiBwYXJzZVNjcmlwdFJ1bnRpbWVFcnJvcigpIHsKICAgIHZhciBzdGFjayA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogJyc7CgogICAgdHJ5IHsKICAgICAgdmFyIGxpbmUgPSAnJywKICAgICAgICAgIGNvbCA9ICcnLAogICAgICAgICAgZmlsZSA9ICcnLAogICAgICAgICAgdXJsID0gJyc7CiAgICAgIHZhciBlcnJJbmZvTGlzdCA9IHN0YWNrLnNwbGl0KC9cblxzKy8pOwogICAgICB2YXIgZXJyTXNnID0gZXJySW5mb0xpc3RbMF07CiAgICAgIHZhciBlcnJTdGFjayA9IGVyckluZm9MaXN0LnNsaWNlKDEpOwogICAgICB2YXIgdHlwZSA9IGVyck1zZy5tYXRjaChlcnJvclR5cGVSZWcpWzBdLnJlcGxhY2UoLzokLywgJycpIHx8ICcnOwogICAgICB2YXIgdmFsdWUgPSBlcnJNc2cuc3BsaXQoL1xuLykucG9wKCkuc3BsaXQoJzonKVsxXS50cmltKCk7IC8vIOacieWPr+iDveayoeaciXN0YWNr5L+h5oGv77yM5aaC5ZyoYXBwLmpz55Sf5ZG95ZGo5pyf6YeM6Z2iCHRocm93IGVycm9yCgogICAgICBpZiAoZXJyU3RhY2subGVuZ3RoKSB7CiAgICAgICAgLy8gOihcZCs6XGQrKSA9PiAgOjI5OjEzCiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lCiAgICAgICAgdmFyIF9zcGxpdCA9ICgvOihcZCs6XGQrKS8uZXhlYyhlcnJTdGFja1swXSlbMV0gfHwgJycpLnNwbGl0KCc6Jyk7CgogICAgICAgIHZhciBfc3BsaXQyID0gX3NsaWNlZFRvQXJyYXkoX3NwbGl0LCAyKTsKCiAgICAgICAgdmFyIF9zcGxpdDIkID0gX3NwbGl0MlswXTsKICAgICAgICBsaW5lID0gX3NwbGl0MiQgPT09IHZvaWQgMCA/ICcnIDogX3NwbGl0MiQ7CiAgICAgICAgdmFyIF9zcGxpdDIkMiA9IF9zcGxpdDJbMV07CiAgICAgICAgY29sID0gX3NwbGl0MiQyID09PSB2b2lkIDAgPyAnJyA6IF9zcGxpdDIkMjsKICAgICAgICAvLyBcdys6XC9cLysgICAgPT4gd2VhcHA6Ly8vCiAgICAgICAgLy8gaHR0cHM/OlwvXC8gID0+IGh0dHA6Ly8gb3IgaHR0cHM6Ly8KICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUKICAgICAgICBmaWxlID0gKC8oXHcrOlwvXC8rfGh0dHBzPzpcL1wvKS4rOlxkKzpcZCsvLmV4ZWMoZXJyU3RhY2tbMF0pWzBdIHx8ICcnKS5yZXBsYWNlKC86XGQrOlxkKyQvLCAnJykgfHwgJyc7CiAgICAgICAgdXJsID0gKC8oXHcrOlwvXC8rfGh0dHBzPzpcL1wvKS4rOlxkKzpcZCsvLmV4ZWMoZXJyU3RhY2tbMV0pWzBdIHx8ICcnKS5yZXBsYWNlKC86XGQrOlxkKyQvLCAnJykgfHwgJyc7CiAgICAgIH0KCiAgICAgIHJldHVybiB7CiAgICAgICAgbGluZTogbGluZSwKICAgICAgICBjb2w6IGNvbCwKICAgICAgICBmaWxlOiBmaWxlLAogICAgICAgIHVybDogdXJsLAogICAgICAgIHN0YWNrOiBzdGFjaywKICAgICAgICB0eXBlOiB0eXBlLAogICAgICAgIHZhbHVlOiB2YWx1ZQogICAgICB9OwogICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgIGNvbnNvbGUubG9nKCdlcnJJbmZvTGlzdC0zLS0tJywgZXJyKTsKICAgICAgcmV0dXJuIHsKICAgICAgICBzdGFjazogc3RhY2ssCiAgICAgICAgdHlwZTogJ0Vycm9yJwogICAgICB9OwogICAgfQogIH0KCiAgZnVuY3Rpb24gcGFyc2VTdGF0aWNFcnJvcihldmVudCwgdGFyZ2V0KSB7CiAgICB2YXIgdXJsID0gdGFyZ2V0LnNyYyB8fCB0YXJnZXQuaHJlZjsKICAgIHJldHVybiB7CiAgICAgIHN0YWNrOiB1cmwsCiAgICAgIGZpbGU6IHVybCwKICAgICAgdHlwZTogIlJlZmVyZW5jZUVycm9yIiwKICAgICAgdmFsdWU6ICfotYTmupDliqDovb3lvILluLgnCiAgICB9OwogIH0KICAvKiBlc2xpbnQtZGlzYWJsZSBuby11bmRlZiAqLwoKCiAgdmFyIHBsdWdpbkhvb2tBcHAgPSB7CiAgICBpbml0OiBmdW5jdGlvbiBpbml0KGNvcmUpIHsKICAgICAgLy8g5LiA77ya5o2V6I635q2j5bi46ZSZ6K+v5ZKM6LWE5rqQ5Yqg6L296ZSZ6K+vCiAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdlcnJvcicsIGZ1bmN0aW9uIChldmVudCkgewogICAgICAgIGNvbnNvbGUubG9nKCdNWjUtLS0nLCAxKTsKICAgICAgICB2YXIgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0IHx8IGV2ZW50LnNyY0VsZW1lbnQ7CiAgICAgICAgdmFyIGlzRWxlbWVudFRhcmdldCA9IHRhcmdldCBpbnN0YW5jZW9mIEhUTUxTY3JpcHRFbGVtZW50IHx8IHRhcmdldCBpbnN0YW5jZW9mIEhUTUxMaW5rRWxlbWVudCB8fCB0YXJnZXQgaW5zdGFuY2VvZiBIVE1MSW1hZ2VFbGVtZW50OwogICAgICAgIGNvbnNvbGUubG9nKCdNWjYtLS0nLCAxKTsKCiAgICAgICAgdmFyIF9fbG9nID0gaXNFbGVtZW50VGFyZ2V0ID8gcGFyc2VTdGF0aWNFcnJvcihldmVudCwgdGFyZ2V0KSA6IHBhcnNlU2NyaXB0UnVudGltZUVycm9yKGV2ZW50LmVycm9yLnN0YWNrKTsKCiAgICAgICAgY29yZS5hZGRMb2coX19sb2cpOwogICAgICAgIGNvbnNvbGUubG9nKCdNWi0tLScsIF9fbG9nKTsgLy8gICAgY29yZS5yZXBvcnQoKTsKICAgICAgfSwgdHJ1ZSk7IC8vIOS6jO+8muaNleiOt2NvbnNvbGUuZXJyb3LplJnor68KICAgICAgLy8gY29uc29sZS5lcnJvciA9IChmdW5jID0+IHsKICAgICAgLy8gICByZXR1cm4gKC4uLmFyZ3MpID0+IHsKICAgICAgLy8gICAgIGNvcmUuYWRkTG9nKC4uLmFyZ3MpOwogICAgICAvLyAgICAgZnVuYy5hcHBseShjb25zb2xlLCBhcmdzKTsKICAgICAgLy8gICB9CiAgICAgIC8vIH0pKGNvbnNvbGUuZXJyb3IpOwogICAgICAvLyDkuInvvJrmjZXojrdQcm9taXNl6ZSZ6K+vCgogICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigndW5oYW5kbGVkcmVqZWN0aW9uJywgZnVuY3Rpb24gKGUpIHsKICAgICAgICB2YXIgX19sb2cgPSBwYXJzZVNjcmlwdFJ1bnRpbWVFcnJvcihlLnJlYXNvbi5zdGFjayk7CgogICAgICAgIGNvcmUuYWRkTG9nKF9fbG9nKTsKICAgICAgICBjb25zb2xlLmxvZygnTVo0LS0tJywgX19sb2cpOyAvLyAgY29yZS5yZXBvcnQoKTsKICAgICAgICAvLyBjb25zb2xlLmxvZyhgUHJvbWlzZS5yZWplY3QoKeS4reeahOWGheWuue+8jOWRiuivieS9oOWPkeeUn+mUmeivr+eahOWOn+WboDoke2UucmVhc29ufWApOwogICAgICAgIC8vIGNvbnNvbGUubG9nKGBQcm9taXNl5a+56LGhIDoke2UucHJvbWlzZX1gKTsKICAgICAgfSk7CiAgICB9CiAgfTsKCiAgZnVuY3Rpb24gUmVxdWVzdChjb25maWcpIHsKICAgIHZhciB1cmwgPSBjb25maWcudXJsLAogICAgICAgIG1ldGhvZCA9IGNvbmZpZy5tZXRob2QsCiAgICAgICAgZGF0YSA9IGNvbmZpZy5kYXRhOwogICAgdmFyIHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpOwogICAgeGhyLm9wZW4obWV0aG9kLCB1cmwsIHRydWUpOwogICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoJ2NvbnRlbnQtdHlwZScsICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnKTsKICAgIHhoci5zZW5kKCd1ZT0nICsgSlNPTi5zdHJpbmdpZnkoZGF0YSkpOwogICAgcmV0dXJuIHhocjsKICB9CgogIHZhciBSZXBvcnRvciA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX0JlaGF2aW9yUmVwb3J0ZXIpIHsKICAgIF9pbmhlcml0cyhSZXBvcnRvciwgX0JlaGF2aW9yUmVwb3J0ZXIpOwoKICAgIHZhciBfc3VwZXIgPSBfY3JlYXRlU3VwZXIoUmVwb3J0b3IpOwoKICAgIGZ1bmN0aW9uIFJlcG9ydG9yKCkgewogICAgICB2YXIgb3B0cyA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDoge307CgogICAgICB2YXIgX3RoaXM7CgogICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgUmVwb3J0b3IpOwoKICAgICAgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBvcHRzKTsgLy8g5ZCI5bm25Y+C5pWwCgogICAgICBfdGhpcy5tZXJnZUNvbmZpZyhvcHRzKTsKCiAgICAgIF90aGlzLmluaXQoKTsKCiAgICAgIHJldHVybiBfdGhpczsKICAgIH0KCiAgICBfY3JlYXRlQ2xhc3MoUmVwb3J0b3IsIFt7CiAgICAgIGtleTogImluaXQiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gaW5pdCgpIHsKICAgICAgICAvLyDliqvmjIEgQXBwIG9uRXJyb3IKICAgICAgICAvLyB0aGlzLnVzZShhZGRFdmVudExpc3RlbmVyKTsKICAgICAgICB0aGlzLnVzZShwbHVnaW5Ib29rQXBwKTsgLy8gLy8g5Yqr5oyBIFJlcXVlc3QKICAgICAgICAvLyB0aGlzLnVzZShwbHVnaW5Ib29rUnEpOwogICAgICAgIC8vIHRoaXMudXNlKHBsdWdpblBhdGNoUHJvbWlzZSk7CgogICAgICAgIHRoaXMuYXBwbHlSZXF1ZXN0KFJlcXVlc3QpOwogICAgICB9CiAgICB9XSk7CgogICAgcmV0dXJuIFJlcG9ydG9yOwogIH0oQmVoYXZpb3JSZXBvcnRlcik7CgogIHJldHVybiBSZXBvcnRvcjsKfSk7"},{"version":3,"sources":["/Users/Aaron/Desktop/work/qunar/work/sniperjs/packages/WebErrorReporter/dist/index.js"],"names":["global","factory","exports","module","define","amd","self","Sniperjs","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","_createClass","protoProps","staticProps","prototype","_inherits","subClass","superClass","create","constructor","value","_setPrototypeOf","_getPrototypeOf","o","setPrototypeOf","getPrototypeOf","__proto__","p","_isNativeReflectConstruct","Reflect","construct","sham","Proxy","Date","toString","call","e","_assertThisInitialized","ReferenceError","_possibleConstructorReturn","_createSuper","Derived","hasNativeReflectConstruct","_createSuperInternal","Super","result","NewTarget","arguments","apply","_defineProperty","obj","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","push","_objectSpread2","source","forEach","getOwnPropertyDescriptors","defineProperties","isPlainObject","isString","isArray","isEmptyObject","isBoolean","isFunction","isNumber","isNaN","isPromise","Promise","resolve","extend","getAgent","window","history","wx","swan","my","tt","qq","quick","err","getGlobal","getSystemInfo","globalObj","systemInfo","getSystemInfoSync","getMeta","agent","system","assign","_defineProperty$1","ownKeys$1","_objectSpread2$1","throwErr","Error","strategies","url","validate","val","msgRequred","appVersion","msgTypeErr","env","repeat","ignoreErrors","autoBreadcrumbs","breadcrumbsMax","random","msgRangeErr","delay","beforeReport","proxyValidate","proxyObj","set","validateConfig","config","proxy","prop","BehaviorReporter","logQueue","appkey","log","applyRequested","delayTimer","mergeConfig","opts","addLog","getLog","slice","clearLog","report","curLogQueue","clearTimeout","setTimeout","sendLog","gLog","logs","data","ret","then","res","startReport","request","method","use","plugin","args","init","applyRequest","errorTypeReg","RegExp","join","parseScriptRuntimeError","stack","line","col","file","errInfoList","split","errMsg","errStack","type","match","replace","pop","trim","exec","console","parseStaticError","event","src","href","pluginHookApp","core","addEventListener","srcElement","isElementTarget","HTMLScriptElement","HTMLLinkElement","HTMLImageElement","__log","error","reason","Request","xhr","XMLHttpRequest","open","setRequestHeader","send","JSON","stringify","Reportor","_BehaviorReporter","_super","_this"],"mappings":"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","sourcesContent":["(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  (global = global || self, global.Sniperjs = factory());\n}(this, (function () { 'use strict';\n\n  function _classCallCheck(instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n      throw new TypeError(\"Cannot call a class as a function\");\n    }\n  }\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  function _createClass(Constructor, protoProps, staticProps) {\n    if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) _defineProperties(Constructor, staticProps);\n    return Constructor;\n  }\n\n  function _inherits(subClass, superClass) {\n    if (typeof superClass !== \"function\" && superClass !== null) {\n      throw new TypeError(\"Super expression must either be null or a function\");\n    }\n\n    subClass.prototype = Object.create(superClass && superClass.prototype, {\n      constructor: {\n        value: subClass,\n        writable: true,\n        configurable: true\n      }\n    });\n    if (superClass) _setPrototypeOf(subClass, superClass);\n  }\n\n  function _getPrototypeOf(o) {\n    _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n      return o.__proto__ || Object.getPrototypeOf(o);\n    };\n    return _getPrototypeOf(o);\n  }\n\n  function _setPrototypeOf(o, p) {\n    _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n      o.__proto__ = p;\n      return o;\n    };\n\n    return _setPrototypeOf(o, p);\n  }\n\n  function _isNativeReflectConstruct() {\n    if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n    if (Reflect.construct.sham) return false;\n    if (typeof Proxy === \"function\") return true;\n\n    try {\n      Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));\n      return true;\n    } catch (e) {\n      return false;\n    }\n  }\n\n  function _assertThisInitialized(self) {\n    if (self === void 0) {\n      throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n    }\n\n    return self;\n  }\n\n  function _possibleConstructorReturn(self, call) {\n    if (call && (typeof call === \"object\" || typeof call === \"function\")) {\n      return call;\n    }\n\n    return _assertThisInitialized(self);\n  }\n\n  function _createSuper(Derived) {\n    var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n    return function _createSuperInternal() {\n      var Super = _getPrototypeOf(Derived),\n          result;\n\n      if (hasNativeReflectConstruct) {\n        var NewTarget = _getPrototypeOf(this).constructor;\n\n        result = Reflect.construct(Super, arguments, NewTarget);\n      } else {\n        result = Super.apply(this, arguments);\n      }\n\n      return _possibleConstructorReturn(this, result);\n    };\n  }\n\n  function _defineProperty(obj, key, value) {\n    if (key in obj) {\n      Object.defineProperty(obj, key, {\n        value: value,\n        enumerable: true,\n        configurable: true,\n        writable: true\n      });\n    } else {\n      obj[key] = value;\n    }\n\n    return obj;\n  }\n\n  function ownKeys(object, enumerableOnly) {\n    var keys = Object.keys(object);\n\n    if (Object.getOwnPropertySymbols) {\n      var symbols = Object.getOwnPropertySymbols(object);\n      if (enumerableOnly) symbols = symbols.filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n      });\n      keys.push.apply(keys, symbols);\n    }\n\n    return keys;\n  }\n\n  function _objectSpread2(target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i] != null ? arguments[i] : {};\n\n      if (i % 2) {\n        ownKeys(Object(source), true).forEach(function (key) {\n          _defineProperty(target, key, source[key]);\n        });\n      } else if (Object.getOwnPropertyDescriptors) {\n        Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n      } else {\n        ownKeys(Object(source)).forEach(function (key) {\n          Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n        });\n      }\n    }\n\n    return target;\n  }\n  /* eslint-disable no-empty */\n\n  /* eslint-disable no-undef */\n\n\n  const {\n    toString\n  } = Object.prototype;\n\n  function isPlainObject(target) {\n    return toString.call(target) === '[object Object]';\n  }\n\n  function isString(target) {\n    return toString.call(target) === '[object String]';\n  }\n\n  function isArray(target) {\n    return toString.call(target) === '[object Array]';\n  }\n\n  function isEmptyObject(target) {\n    if (!isPlainObject(target)) return false;\n    return Object.keys(target).length > 0;\n  }\n\n  function isBoolean(target) {\n    return toString.call(target) === '[object Boolean]';\n  }\n\n  function isFunction(target) {\n    return typeof target === 'function';\n  }\n\n  function isNumber(target) {\n    // eslint-disable-next-line no-restricted-globals\n    return toString.call(target) === '[object Number]' && !isNaN(target);\n  }\n\n  function isPromise(object) {\n    if (Promise && Promise.resolve) {\n      return Promise.resolve(object) == object;\n    }\n  }\n\n  function extend(target, source) {\n    return _objectSpread2(_objectSpread2({}, target), source);\n  }\n\n  function getAgent() {\n    try {\n      if (window && window.history) {\n        return 'WEB_APP';\n      }\n\n      if (wx) {\n        return 'WX_MINI_APP';\n      }\n\n      if (swan) {\n        return 'BAIDU_MINI_APP';\n      }\n\n      if (my) {\n        return 'ALIPAY_MINI_APP';\n      }\n\n      if (tt) {\n        return 'TT_MINI_APP';\n      }\n\n      if (qq) {\n        return 'QQ_MINI_APP';\n      }\n\n      if (quick) {\n        return 'QUICK_APP';\n      }\n    } catch (err) {\n      return 'UNKNOWN_APP';\n    }\n  }\n\n  function getGlobal() {\n    try {\n      if (window && window.history) {\n        return window;\n      }\n\n      if (wx) {\n        return wx;\n      }\n\n      if (swan) {\n        return swan;\n      }\n\n      if (my) {\n        return my;\n      }\n\n      if (tt) {\n        return tt;\n      }\n\n      if (qq) {\n        return qq;\n      }\n    } catch (err) {\n      return {};\n    }\n  }\n\n  function getSystemInfo() {\n    // 这里做个缓存\n    const globalObj = getGlobal();\n    const key = '__sniper__internal__data__';\n\n    if (globalObj[key] && !isEmptyObject(globalObj[key].systemInfo || {})) {\n      return globalObj[key].systemInfo;\n    }\n\n    try {\n      const systemInfo = globalObj.getSystemInfoSync();\n      globalObj[key] = globalObj[key] || {};\n      globalObj[key].systemInfo = systemInfo;\n      return systemInfo;\n    } catch (err) {\n      return {};\n    }\n  }\n\n  function getMeta() {\n    return {\n      agent: getAgent(),\n      system: Object.assign({}, getSystemInfo())\n    };\n  }\n\n  function _defineProperty$1(obj, key, value) {\n    if (key in obj) {\n      Object.defineProperty(obj, key, {\n        value: value,\n        enumerable: true,\n        configurable: true,\n        writable: true\n      });\n    } else {\n      obj[key] = value;\n    }\n\n    return obj;\n  }\n\n  function ownKeys$1(object, enumerableOnly) {\n    var keys = Object.keys(object);\n\n    if (Object.getOwnPropertySymbols) {\n      var symbols = Object.getOwnPropertySymbols(object);\n      if (enumerableOnly) symbols = symbols.filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n      });\n      keys.push.apply(keys, symbols);\n    }\n\n    return keys;\n  }\n\n  function _objectSpread2$1(target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i] != null ? arguments[i] : {};\n\n      if (i % 2) {\n        ownKeys$1(Object(source), true).forEach(function (key) {\n          _defineProperty$1(target, key, source[key]);\n        });\n      } else if (Object.getOwnPropertyDescriptors) {\n        Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n      } else {\n        ownKeys$1(Object(source)).forEach(function (key) {\n          Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n        });\n      }\n    }\n\n    return target;\n  }\n\n  function throwErr(err) {\n    throw new Error(err);\n  }\n\n  const strategies = {\n    url: {\n      validate(val) {\n        if (!val) {\n          throwErr(this.msgRequred);\n        }\n      },\n\n      msgRequred: 'SNIPER ERROR: 配置中 url 字段必填.'\n    },\n    appVersion: {\n      validate(val) {\n        if (!val) return;\n\n        if (!isString(val)) {\n          throwErr(this.msgTypeErr);\n        }\n      },\n\n      msgTypeErr: 'SNIPER ERROR: 配置中 appVersion 字段类型需为 String.'\n    },\n    env: {\n      validate(val) {\n        if (!val) return;\n\n        if (!isString(val)) {\n          throwErr(this.msgTypeErr);\n        }\n      },\n\n      msgTypeErr: 'SNIPER ERROR: 配置中 env 字段类型需为 String.'\n    },\n    repeat: {\n      validate(val) {\n        if (!isNumber(val)) {\n          throwErr(this.msgTypeErr);\n        }\n      },\n\n      msgTypeErr: 'SNIPER ERROR: 配置中 repeat 字段类型需为 Number.'\n    },\n    ignoreErrors: {\n      validate(val) {\n        if (!isArray(val)) {\n          throwErr(this.msgTypeErr);\n        }\n      },\n\n      msgTypeErr: 'SNIPER ERROR: 配置中 ignoreErrors 字段类型需为 Array.'\n    },\n    autoBreadcrumbs: {\n      validate(val) {\n        if (!isBoolean(val)) {\n          throwErr(this.msgTypeErr);\n        }\n      },\n\n      msgTypeErr: 'SNIPER ERROR: 配置中 autoBreadcrumbs 字段类型需为 Array.'\n    },\n    breadcrumbsMax: {\n      validate(val) {\n        if (!isNumber(val)) {\n          throwErr(this.msgTypeErr);\n        }\n      },\n\n      msgTypeErr: 'SNIPER ERROR: 配置中 breadcrumbsMax 字段类型需为 Number.'\n    },\n    random: {\n      validate(val) {\n        if (!isNumber(val)) {\n          throwErr(this.msgTypeErr);\n        } else if (!(val > 0 && val <= 1)) {\n          throwErr(this.msgRangeErr);\n        }\n      },\n\n      msgTypeErr: 'SNIPER ERROR: 配置中 breadcrumbsMax 字段类型需为 Number.',\n      msgRangeErr: 'SNIPER ERROR: 配置中 breadcrumbsMax 字段范围需满足 (0, 1]'\n    },\n    delay: {\n      validate(val) {\n        if (!isNumber(val)) {\n          throwErr(this.msgTypeErr);\n        }\n      },\n\n      msgTypeErr: 'SNIPER ERROR: 配置中 delay 字段类型需为 Number.'\n    },\n    beforeReport: {\n      validate(val) {\n        if (!isFunction(val)) {\n          throwErr(this.msgTypeErr);\n        }\n      },\n\n      msgTypeErr: 'SNIPER ERROR: 配置中 beforeReport 字段类型需为 Function.'\n    }\n  };\n\n  function proxyValidate() {\n    const proxyObj = {};\n    return new Proxy(proxyObj, {\n      set(target, key, val) {\n        strategies[key].validate(val); // eslint-disable-next-line no-param-reassign\n\n        target[key] = val;\n        return true;\n      }\n\n    });\n  }\n\n  function validateConfig(config) {\n    const proxy = proxyValidate();\n    Object.keys(config).forEach(prop => {\n      proxy[prop] = config[prop];\n    });\n  }\n\n  let BehaviorReporter = /*#__PURE__*/function () {\n    function BehaviorReporter() {\n      _classCallCheck(this, BehaviorReporter);\n\n      this.logQueue = [];\n      this.config = {\n        url: '',\n        appkey: '',\n        // 以后商业化要用到的\n        delay: 1000,\n        // 延迟, 合并上报\n        appVersion: '',\n        // 应用Version\n        env: '',\n\n        // 环境\n        beforeReport(log) {\n          // 1.可在这里劫持上报的数据, 比如添加userid, session等等\n          // 2.如果return false, 则不用内置http上报, 此时可以在这里自定义自己的http上报方式\n          //   比如以后浏览器端，可以自定义 ajax 上报还是用图片上报\n          return log;\n        }\n\n      };\n      this.applyRequested = false;\n      this.delayTimer = -1;\n    }\n\n    _createClass(BehaviorReporter, [{\n      key: \"mergeConfig\",\n      value: function mergeConfig(opts) {\n        validateConfig(opts);\n        this.config = extend(this.config, opts);\n      }\n    }, {\n      key: \"addLog\",\n      value: function addLog(log) {\n        this.logQueue.push(log);\n        return this;\n      }\n    }, {\n      key: \"getLog\",\n      value: function getLog() {\n        return this.logQueue.slice();\n      }\n    }, {\n      key: \"clearLog\",\n      value: function clearLog() {\n        this.logQueue = [];\n        return this;\n      }\n    }, {\n      key: \"report\",\n      value: function report() {\n        const curLogQueue = this.getLog();\n\n        if (this.config.delay > 0) {\n          if (this.delayTimer) {\n            clearTimeout(this.delayTimer);\n          }\n\n          this.delayTimer = setTimeout(() => {\n            this.sendLog(curLogQueue);\n          }, this.config.delay);\n        } else {\n          this.sendLog(curLogQueue);\n        }\n      }\n    }, {\n      key: \"gLog\",\n      value: function gLog(log) {\n        const {\n          appVersion,\n          env\n        } = this.config;\n        return _objectSpread2$1(_objectSpread2$1({}, getMeta()), {}, {\n          appVersion,\n          env,\n          logs: log\n        });\n      }\n    }, {\n      key: \"sendLog\",\n      value: function sendLog(logQueue = []) {\n        const log = logQueue.slice();\n        if (!log.length) return;\n        const data = this.gLog(log);\n        const ret = isFunction(this.config.beforeReport) && this.config.beforeReport.call(this, data); // 异步回调\n\n        if (isPromise(ret)) {\n          ret.then(res => {\n            if (isBoolean(res) && res === false) {\n              // 用户阻止默认上报后，可在 beforeReport 可自定义 request 上报\n              return;\n            }\n\n            this.startReport(res);\n          });\n        } else {\n          if (isBoolean(ret) && ret === false) {\n            // 用户阻止默认上报后，可在 beforeReport 可自定义 request 上报\n            return;\n          }\n\n          this.startReport(ret);\n        }\n      }\n    }, {\n      key: \"startReport\",\n      value: function startReport(data) {\n        this.clearLog(); // 默认上报\n\n        this.request({\n          url: this.config.url,\n          method: 'POST',\n          data\n        });\n      }\n    }, {\n      key: \"use\",\n      value: function use(plugin, ...args) {\n        plugin.init(this, ...args);\n      }\n    }, {\n      key: \"applyRequest\",\n      value: function applyRequest(request) {\n        if (this.applyRequested) return false;\n        this.request = request;\n        this.applyRequested = true;\n        return true;\n      }\n    }]);\n\n    return BehaviorReporter;\n  }();\n\n  const errorTypeReg = new RegExp('(' + ['EvalError:', 'InternalError:', 'RangeError:', 'ReferenceError:', 'SyntaxError:', 'TypeError:', 'URIError:', 'Error:' // new Error\n  ].join('|') + ')', 'mi');\n\n  /* eslint-disable key-spacing */\n\n  function parseScriptRuntimeError(stack = '') {\n    try {\n      let line = '',\n          col = '',\n          file = '',\n          url = '';\n      const errInfoList = stack.split(/\\n\\s+/);\n      const errMsg = errInfoList[0];\n      const errStack = errInfoList.slice(1);\n      const type = errMsg.match(errorTypeReg)[0].replace(/:$/, '') || '';\n      const value = errMsg.split(/\\n/).pop().split(':')[1].trim(); // 有可能没有stack信息，如在app.js生命周期里面\bthrow error\n\n      if (errStack.length) {\n        // :(\\d+:\\d+) =>  :29:13\n        // eslint-disable-next-line\n        [line = '', col = ''] = (/:(\\d+:\\d+)/.exec(errStack[0])[1] || '').split(':'); // \\w+:\\/\\/+    => weapp:///\n        // https?:\\/\\/  => http:// or https://\n        // eslint-disable-next-line\n\n        file = (/(\\w+:\\/\\/+|https?:\\/\\/).+:\\d+:\\d+/.exec(errStack[0])[0] || '').replace(/:\\d+:\\d+$/, '') || '';\n        url = (/(\\w+:\\/\\/+|https?:\\/\\/).+:\\d+:\\d+/.exec(errStack[1])[0] || '').replace(/:\\d+:\\d+$/, '') || '';\n      }\n\n      return {\n        line,\n        col,\n        file,\n        url,\n        stack,\n        type,\n        value\n      };\n    } catch (err) {\n      console.log('errInfoList-3---', err);\n      return {\n        stack,\n        type: 'Error'\n      };\n    }\n  }\n\n  function parseStaticError(event, target) {\n    const url = target.src || target.href;\n    return {\n      stack: url,\n      file: url,\n      type: \"ReferenceError\",\n      value: '资源加载异常'\n    };\n  }\n\n  /* eslint-disable no-undef */\n  const pluginHookApp = {\n    init(core) {\n      // 一：捕获正常错误和资源加载错误\n      window.addEventListener('error', event => {\n        console.log('MZ5---', 1);\n        const target = event.target || event.srcElement;\n        const isElementTarget = target instanceof HTMLScriptElement || target instanceof HTMLLinkElement || target instanceof HTMLImageElement;\n        console.log('MZ6---', 1);\n\n        const __log = isElementTarget ? parseStaticError(event, target) : parseScriptRuntimeError(event.error.stack);\n\n        core.addLog(__log);\n        console.log('MZ---', __log); //    core.report();\n      }, true); // 二：捕获console.error错误\n      // console.error = (func => {\n      //   return (...args) => {\n      //     core.addLog(...args);\n      //     func.apply(console, args);\n      //   }\n      // })(console.error);\n      // 三：捕获Promise错误\n\n      window.addEventListener('unhandledrejection', e => {\n        const __log = parseScriptRuntimeError(e.reason.stack);\n\n        core.addLog(__log);\n        console.log('MZ4---', __log); //  core.report();\n        // console.log(`Promise.reject()中的内容，告诉你发生错误的原因:${e.reason}`);\n        // console.log(`Promise对象 :${e.promise}`);\n      });\n    }\n\n  };\n\n  function Request(config) {\n    const {\n      url,\n      method,\n      data\n    } = config;\n    let xhr = new XMLHttpRequest();\n    xhr.open(method, url, true);\n    xhr.setRequestHeader('content-type', 'application/x-www-form-urlencoded');\n    xhr.send('ue=' + JSON.stringify(data));\n    return xhr;\n  }\n\n  let Reportor = /*#__PURE__*/function (_BehaviorReporter) {\n    _inherits(Reportor, _BehaviorReporter);\n\n    var _super = _createSuper(Reportor);\n\n    function Reportor(opts = {}) {\n      var _this;\n\n      _classCallCheck(this, Reportor);\n\n      _this = _super.call(this, opts); // 合并参数\n\n      _this.mergeConfig(opts);\n\n      _this.init();\n\n      return _this;\n    }\n\n    _createClass(Reportor, [{\n      key: \"init\",\n      value: function init() {\n        // 劫持 App onError\n        // this.use(addEventListener);\n        this.use(pluginHookApp); // // 劫持 Request\n        // this.use(pluginHookRq);\n        // this.use(pluginPatchPromise);\n\n        this.applyRequest(Request);\n      }\n    }]);\n\n    return Reportor;\n  }(BehaviorReporter);\n\n  return Reportor;\n\n})));\n"]}]}